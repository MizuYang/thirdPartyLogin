import{g as ei,i as ts,a as ns,_ as cr,C as ur,r as lr,b as rs,S as ht,c as je,E as Pn,d as is,L as ti,e as ee,f as ni,h as os,j as ss,k as as,F as On,l as cs,q as pt,m as us,n as ls,o as ds,p as rt,s as An,t as me,u as ve,v as A,w as Ne,x as fs,y as ut,z as hs,A as ps,B as Zt}from"./index-1ae5e07f.js";var fn=function(t,e){return fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},fn(t,e)};function S(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");fn(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var R=function(){return R=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},R.apply(this,arguments)};function Rn(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function p(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function c(l){try{u(r.next(l))}catch(d){s(d)}}function a(l){try{u(r.throw(l))}catch(d){s(d)}}function u(l){l.done?o(l.value):i(l.value).then(c,a)}u((r=r.apply(t,e||[])).next())})}function g(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,s;return s={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(u){return function(l){return a([u,l])}}function a(u){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(n=0)),n;)try{if(r=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],i=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Wt(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),i,o=[],s;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(c){s={error:c}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function ce(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}function gs(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function ri(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ms=ri,ii=new Pn("auth","Firebase",ri());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nt=new as("@firebase/auth");function vs(t,...e){Nt.logLevel<=ti.WARN&&Nt.warn(`Auth (${ht}): ${t}`,...e)}function kt(t,...e){Nt.logLevel<=ti.ERROR&&Nt.error(`Auth (${ht}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(t,...e){throw Ln(t,...e)}function de(t,...e){return Ln(t,...e)}function oi(t,e,n){const r=Object.assign(Object.assign({},ms()),{[e]:n});return new Pn("auth","Firebase",r).create(e,{appName:t.name})}function ws(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&he(t,"argument-error"),oi(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ln(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return ii.create(t,...e)}function I(t,e,...n){if(!t)throw Ln(e,...n)}function we(t){const e="INTERNAL ASSERTION FAILED: "+t;throw kt(e),new Error(e)}function _e(t,e){t||we(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hn(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ys(){return dr()==="http:"||dr()==="https:"}function dr(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bs(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ys()||rs()||"connection"in navigator)?navigator.onLine:!0}function _s(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e,n){this.shortDelay=e,this.longDelay=n,_e(n>e,"Short delay should be less than long delay!"),this.isMobile=ts()||ns()}get(){return bs()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(t,e){_e(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;we("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;we("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;we("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts=new gt(3e4,6e4);function Un(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xe(t,e,n,r,i={}){return ai(t,i,async()=>{let o={},s={};r&&(e==="GET"?s=r:o={body:JSON.stringify(r)});const c=pt(Object.assign({key:t.config.apiKey},s)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),si.fetch()(ci(t,t.config.apiHost,n,c),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},o))})}async function ai(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Is),e);try{const i=new Es(t),o=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw It(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const c=o.ok?s.errorMessage:s.error.message,[a,u]=c.split(" : ");if(a==="FEDERATED_USER_ID_ALREADY_LINKED")throw It(t,"credential-already-in-use",s);if(a==="EMAIL_EXISTS")throw It(t,"email-already-in-use",s);if(a==="USER_DISABLED")throw It(t,"user-disabled",s);const l=r[a]||a.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw oi(t,l,u);he(t,l)}}catch(i){if(i instanceof On)throw i;he(t,"network-request-failed",{message:String(i)})}}async function Ss(t,e,n,r,i={}){const o=await Xe(t,e,n,r,i);return"mfaPendingCredential"in o&&he(t,"multi-factor-auth-required",{_serverResponse:o}),o}function ci(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Nn(t.config,i):`${t.config.apiScheme}://${i}`}class Es{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(de(this.auth,"network-request-failed")),Ts.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function It(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=de(t,e,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ks(t,e){return Xe(t,"POST","/v1/accounts:delete",e)}async function Cs(t,e){return Xe(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ps(t,e=!1){const n=je(t),r=await n.getIdToken(e),i=xn(r);I(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:it(en(i.auth_time)),issuedAtTime:it(en(i.iat)),expirationTime:it(en(i.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function en(t){return Number(t)*1e3}function xn(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return kt("JWT malformed, contained fewer than 3 sections"),null;try{const i=us(n);return i?JSON.parse(i):(kt("Failed to decode base64 JWT payload"),null)}catch(i){return kt("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Os(t){const e=xn(t);return I(e,"internal-error"),I(typeof e.exp<"u","internal-error"),I(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lt(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof On&&As(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function As({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=it(this.lastLoginAt),this.creationTime=it(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ut(t){var e;const n=t.auth,r=await t.getIdToken(),i=await lt(t,Cs(n,{idToken:r}));I(i==null?void 0:i.users.length,n,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?Us(o.providerUserInfo):[],c=Ns(t.providerData,s),a=t.isAnonymous,u=!(t.email&&o.passwordHash)&&!(c!=null&&c.length),l=a?u:!1,d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new ui(o.createdAt,o.lastLoginAt),isAnonymous:l};Object.assign(t,d)}async function Ls(t){const e=je(t);await Ut(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ns(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Us(t){return t.map(e=>{var{providerId:n}=e,r=Rn(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xs(t,e){const n=await ai(t,{},async()=>{const r=pt({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,s=ci(t,i,"/v1/token",`key=${o}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",si.fetch()(s,{method:"POST",headers:c,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Ds(t,e){return Xe(t,"POST","/v2/accounts:revokeToken",Un(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){I(e.idToken,"internal-error"),I(typeof e.idToken<"u","internal-error"),I(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Os(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return I(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:o}=await xs(e,n);this.updateTokensAndExpiration(r,i,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:o}=n,s=new dt;return r&&(I(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(I(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(I(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dt,this.toJSON())}_performRefresh(){return we("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t,e){I(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class De{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,o=Rn(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Rs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ui(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await lt(this,this.stsTokenManager.getToken(this.auth,e));return I(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ps(this,e)}reload(){return Ls(this)}_assign(e){this!==e&&(I(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new De(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){I(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ut(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await lt(this,ks(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,o,s,c,a,u,l;const d=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(i=n.email)!==null&&i!==void 0?i:void 0,h=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,v=(s=n.photoURL)!==null&&s!==void 0?s:void 0,y=(c=n.tenantId)!==null&&c!==void 0?c:void 0,_=(a=n._redirectEventId)!==null&&a!==void 0?a:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,b=(l=n.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:j,emailVerified:U,isAnonymous:Y,providerData:B,stsTokenManager:Q}=n;I(j&&Q,e,"internal-error");const bt=dt.fromJSON(this.name,Q);I(typeof j=="string",e,"internal-error"),Se(d,e.name),Se(m,e.name),I(typeof U=="boolean",e,"internal-error"),I(typeof Y=="boolean",e,"internal-error"),Se(h,e.name),Se(v,e.name),Se(y,e.name),Se(_,e.name),Se(w,e.name),Se(b,e.name);const et=new De({uid:j,auth:e,email:m,emailVerified:U,displayName:d,isAnonymous:Y,photoURL:v,phoneNumber:h,tenantId:y,stsTokenManager:bt,createdAt:w,lastLoginAt:b});return B&&Array.isArray(B)&&(et.providerData=B.map(_t=>Object.assign({},_t))),_&&(et._redirectEventId=_),et}static async _fromIdTokenResponse(e,n,r=!1){const i=new dt;i.updateFromServerResponse(n);const o=new De({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ut(o),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr=new Map;function ye(t){_e(t instanceof Function,"Expected a class definition");let e=fr.get(t);return e?(_e(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,fr.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}li.type="NONE";const hr=li;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t,e,n){return`firebase:${t}:${e}:${n}`}class He{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:o}=this.auth;this.fullUserKey=Ct(this.userKey,i.apiKey,o),this.fullPersistenceKey=Ct("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?De._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new He(ye(hr),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=i[0]||ye(hr);const s=Ct(r,e.config.apiKey,e.name);let c=null;for(const u of n)try{const l=await u._get(s);if(l){const d=De._fromJSON(e,l);u!==o&&(c=d),o=u;break}}catch{}const a=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!a.length?new He(o,e,r):(o=a[0],c&&await o._set(s,c.toJSON()),await Promise.all(n.map(async u=>{if(u!==o)try{await u._remove(s)}catch{}})),new He(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hi(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(di(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gi(e))return"Blackberry";if(mi(e))return"Webos";if(Dn(e))return"Safari";if((e.includes("chrome/")||fi(e))&&!e.includes("edge/"))return"Chrome";if(pi(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function di(t=ee()){return/firefox\//i.test(t)}function Dn(t=ee()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fi(t=ee()){return/crios\//i.test(t)}function hi(t=ee()){return/iemobile/i.test(t)}function pi(t=ee()){return/android/i.test(t)}function gi(t=ee()){return/blackberry/i.test(t)}function mi(t=ee()){return/webos/i.test(t)}function Ht(t=ee()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function $s(t=ee()){var e;return Ht(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ms(){return ls()&&document.documentMode===10}function vi(t=ee()){return Ht(t)||pi(t)||mi(t)||gi(t)||/windows phone/i.test(t)||hi(t)}function Fs(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wi(t,e=[]){let n;switch(t){case"Browser":n=pr(ee());break;case"Worker":n=`${pr(ee())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ht}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((s,c)=>{try{const a=e(o);s(a)}catch(a){c(a)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bs(t,e={}){return Xe(t,"GET","/v2/passwordPolicy",Un(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws=6;class Hs{constructor(e){var n,r,i,o;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=s.minPasswordLength)!==null&&n!==void 0?n:Ws,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,o,s,c;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=(n=a.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),a.isValid&&(a.isValid=(r=a.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),a.isValid&&(a.isValid=(i=a.containsLowercaseLetter)!==null&&i!==void 0?i:!0),a.isValid&&(a.isValid=(o=a.containsUppercaseLetter)!==null&&o!==void 0?o:!0),a.isValid&&(a.isValid=(s=a.containsNumericCharacter)!==null&&s!==void 0?s:!0),a.isValid&&(a.isValid=(c=a.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),a}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gr(this),this.idTokenSubscription=new gr(this),this.beforeStateQueue=new js(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ii,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ye(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await He.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let i=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const s=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,c=i==null?void 0:i._redirectEventId,a=await this.tryRedirectSignIn(e);(!s||s===c)&&(a!=null&&a.user)&&(i=a.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return I(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ut(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_s()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?je(e):null;return n&&I(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&I(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ye(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Bs(this),n=new Hs(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Pn("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Ds(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ye(e)||this._popupRedirectResolver;I(n,this,"argument-error"),this.redirectPersistenceManager=await He.create(this,[ye(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n);let s=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(I(c,this,"internal-error"),c.then(()=>{s||o(this.currentUser)}),typeof n=="function"){const a=e.addObserver(n,r,i);return()=>{s=!0,a()}}else{const a=e.addObserver(n);return()=>{s=!0,a()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return I(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&vs(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Vt(t){return je(t)}class gr{constructor(e){this.auth=e,this.observer=null,this.addObserver=is(n=>this.observer=n)}get next(){return I(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function Ks(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const o=de("internal-error");o.customData=i,n(o)},r.type="text/javascript",r.charset="UTF-8",Gs().appendChild(r)})}function qs(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(t,e){const n=ni(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),o=n.getOptions();if(cs(o,e??{}))return i;he(i,"already-initialized")}return n.initialize({options:e})}function Js(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ye);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Xs(t,e,n){const r=Vt(t);I(r._canInitEmulator,r,"emulator-config-failed"),I(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!!(n!=null&&n.disableWarnings),o=yi(e),{host:s,port:c}=Ys(e),a=c===null?"":`:${c}`;r.config.emulator={url:`${o}//${s}${a}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||Qs()}function yi(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ys(t){const e=yi(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const o=i[1];return{host:o,port:mr(r.substr(o.length+1))}}else{const[o,s]=r.split(":");return{host:o,port:mr(s)}}}function mr(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Qs(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return we("not implemented")}_getIdTokenResponse(e){return we("not implemented")}_linkToIdToken(e,n){return we("not implemented")}_getReauthenticationResolver(e){return we("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ve(t,e){return Ss(t,"POST","/v1/accounts:signInWithIdp",Un(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs="http://localhost";class $e extends bi{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new $e(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):he("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,o=Rn(n,["providerId","signInMethod"]);if(!r||!i)return null;const s=new $e(r,i);return s.idToken=o.idToken||void 0,s.accessToken=o.accessToken||void 0,s.secret=o.secret,s.nonce=o.nonce,s.pendingToken=o.pendingToken||null,s}_getIdTokenResponse(e){const n=this.buildRequest();return Ve(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ve(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ve(e,n)}buildRequest(){const e={requestUri:Zs,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=pt(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt extends $n{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke extends mt{constructor(){super("facebook.com")}static credential(e){return $e._fromParams({providerId:ke.PROVIDER_ID,signInMethod:ke.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ke.credentialFromTaggedObject(e)}static credentialFromError(e){return ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ke.credential(e.oauthAccessToken)}catch{return null}}}ke.FACEBOOK_SIGN_IN_METHOD="facebook.com";ke.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae extends mt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return $e._fromParams({providerId:ae.PROVIDER_ID,signInMethod:ae.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ae.credentialFromTaggedObject(e)}static credentialFromError(e){return ae.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ae.credential(n,r)}catch{return null}}}ae.GOOGLE_SIGN_IN_METHOD="google.com";ae.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce extends mt{constructor(){super("github.com")}static credential(e){return $e._fromParams({providerId:Ce.PROVIDER_ID,signInMethod:Ce.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ce.credentialFromTaggedObject(e)}static credentialFromError(e){return Ce.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ce.credential(e.oauthAccessToken)}catch{return null}}}Ce.GITHUB_SIGN_IN_METHOD="github.com";Ce.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe extends mt{constructor(){super("twitter.com")}static credential(e,n){return $e._fromParams({providerId:Pe.PROVIDER_ID,signInMethod:Pe.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Pe.credentialFromTaggedObject(e)}static credentialFromError(e){return Pe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Pe.credential(n,r)}catch{return null}}}Pe.TWITTER_SIGN_IN_METHOD="twitter.com";Pe.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const o=await De._fromIdTokenResponse(e,r,i),s=vr(r);return new qe({user:o,providerId:s,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=vr(r);return new qe({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function vr(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt extends On{constructor(e,n,r,i){var o;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,xt.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new xt(e,n,r,i)}}function _i(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?xt._fromErrorAndOperation(t,o,e,r):o})}async function ea(t,e,n=!1){const r=await lt(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return qe._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ta(t,e,n=!1){const{auth:r}=t,i="reauthenticate";try{const o=await lt(t,_i(r,i,e,t),n);I(o.idToken,r,"internal-error");const s=xn(o.idToken);I(s,r,"internal-error");const{sub:c}=s;return I(t.uid===c,r,"user-mismatch"),qe._forOperation(t,i,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&he(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function na(t,e,n=!1){const r="signIn",i=await _i(t,r,e),o=await qe._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(o.user),o}function ra(t,e,n,r){return je(t).onIdTokenChanged(e,n,r)}function ia(t,e,n){return je(t).beforeAuthStateChanged(e,n)}function oa(t){return je(t).signOut()}const Dt="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Dt,"1"),this.storage.removeItem(Dt),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(){const t=ee();return Dn(t)||Ht(t)}const aa=1e3,ca=10;class Ti extends Ii{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=sa()&&Fs(),this.fallbackToPolling=vi(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((s,c,a)=>{this.notifyListeners(s,a)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const s=this.storage.getItem(r);if(e.newValue!==s)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const i=()=>{const s=this.storage.getItem(r);!n&&this.localCache[r]===s||this.notifyListeners(r,s)},o=this.storage.getItem(r);Ms()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,ca):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},aa)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ti.type="LOCAL";const ua=Ti;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends Ii{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Si.type="SESSION";const Ei=Si;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Gt(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:o}=n.data,s=this.handlersMap[i];if(!(s!=null&&s.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const c=Array.from(s).map(async u=>u(n.origin,o)),a=await la(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:a})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gt.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mn(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((c,a)=>{const u=Mn("",20);i.port1.start();const l=setTimeout(()=>{a(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(d){const m=d;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(l),o=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(m.data.response);break;default:clearTimeout(l),clearTimeout(o),a(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(){return window}function fa(t){fe().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(){return typeof fe().WorkerGlobalScope<"u"&&typeof fe().importScripts=="function"}async function ha(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function pa(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function ga(){return ki()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="firebaseLocalStorageDb",ma=1,$t="firebaseLocalStorage",Pi="fbase_key";class vt{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Kt(t,e){return t.transaction([$t],e?"readwrite":"readonly").objectStore($t)}function va(){const t=indexedDB.deleteDatabase(Ci);return new vt(t).toPromise()}function pn(){const t=indexedDB.open(Ci,ma);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore($t,{keyPath:Pi})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains($t)?e(r):(r.close(),await va(),e(await pn()))})})}async function wr(t,e,n){const r=Kt(t,!0).put({[Pi]:e,value:n});return new vt(r).toPromise()}async function wa(t,e){const n=Kt(t,!1).get(e),r=await new vt(n).toPromise();return r===void 0?null:r.value}function yr(t,e){const n=Kt(t,!0).delete(e);return new vt(n).toPromise()}const ya=800,ba=3;class Oi{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pn(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>ba)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ki()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gt._getInstance(ga()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await ha(),!this.activeServiceWorker)return;this.sender=new da(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||pa()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pn();return await wr(e,Dt,"1"),await yr(e,Dt),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>wr(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>wa(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>yr(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=Kt(i,!1).getAll();return new vt(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ya)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Oi.type="LOCAL";const _a=Oi;new gt(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t,e){return e?ye(e):(I(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn extends bi{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ve(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ve(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ve(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Ia(t){return na(t.auth,new Fn(t),t.bypassAuthState)}function Ta(t){const{auth:e,user:n}=t;return I(n,e,"internal-error"),ta(n,new Fn(t),t.bypassAuthState)}async function Sa(t){const{auth:e,user:n}=t;return I(n,e,"internal-error"),ea(n,new Fn(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:o,error:s,type:c}=e;if(s){this.reject(s);return}const a={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(a))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ia;case"linkViaPopup":case"linkViaRedirect":return Sa;case"reauthViaPopup":case"reauthViaRedirect":return Ta;default:he(this.auth,"internal-error")}}resolve(e){_e(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_e(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=new gt(2e3,1e4);async function ka(t,e,n){const r=Vt(t);ws(t,e,$n);const i=Ai(r,n);return new Ue(r,"signInViaPopup",e,i).executeNotNull()}class Ue extends Ri{constructor(e,n,r,i,o){super(e,n,i,o),this.provider=r,this.authWindow=null,this.pollId=null,Ue.currentPopupAction&&Ue.currentPopupAction.cancel(),Ue.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return I(e,this.auth,"internal-error"),e}async onExecution(){_e(this.filter.length===1,"Popup operations only handle one event");const e=Mn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(de(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(de(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ue.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(de(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Ea.get())};e()}}Ue.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca="pendingRedirect",Pt=new Map;class Pa extends Ri{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Pt.get(this.auth._key());if(!e){try{const r=await Oa(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Pt.set(this.auth._key(),e)}return this.bypassAuthState||Pt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Oa(t,e){const n=La(e),r=Ra(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function Aa(t,e){Pt.set(t._key(),e)}function Ra(t){return ye(t._redirectPersistence)}function La(t){return Ct(Ca,t.config.apiKey,t.name)}async function Na(t,e,n=!1){const r=Vt(t),i=Ai(r,e),s=await new Pa(r,i,n).execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ua=10*60*1e3;class xa{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Da(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Li(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(de(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Ua&&this.cachedEventUids.clear(),this.cachedEventUids.has(br(e))}saveEventToCache(e){this.cachedEventUids.add(br(e)),this.lastProcessedEventTime=Date.now()}}function br(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Li({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Da(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Li(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $a(t,e={}){return Xe(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Fa=/^https?/;async function ja(t){if(t.config.emulator)return;const{authorizedDomains:e}=await $a(t);for(const n of e)try{if(Ba(n))return}catch{}he(t,"unauthorized-domain")}function Ba(t){const e=hn(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&s.hostname===r}if(!Fa.test(n))return!1;if(Ma.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=new gt(3e4,6e4);function _r(){const t=fe().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Ha(t){return new Promise((e,n)=>{var r,i,o;function s(){_r(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_r(),n(de(t,"network-request-failed"))},timeout:Wa.get()})}if(!((i=(r=fe().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=fe().gapi)===null||o===void 0)&&o.load)s();else{const c=qs("iframefcb");return fe()[c]=()=>{gapi.load?s():n(de(t,"network-request-failed"))},Ks(`https://apis.google.com/js/api.js?onload=${c}`).catch(a=>n(a))}}).catch(e=>{throw Ot=null,e})}let Ot=null;function Va(t){return Ot=Ot||Ha(t),Ot}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new gt(5e3,15e3),Ka="__/auth/iframe",qa="emulator/auth/iframe",za={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ja=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Xa(t){const e=t.config;I(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Nn(e,qa):`https://${t.config.authDomain}/${Ka}`,r={apiKey:e.apiKey,appName:t.name,v:ht},i=Ja.get(t.config.apiHost);i&&(r.eid=i);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${pt(r).slice(1)}`}async function Ya(t){const e=await Va(t),n=fe().gapi;return I(n,t,"internal-error"),e.open({where:document.body,url:Xa(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:za,dontclear:!0},r=>new Promise(async(i,o)=>{await r.restyle({setHideOnLeave:!1});const s=de(t,"network-request-failed"),c=fe().setTimeout(()=>{o(s)},Ga.get());function a(){fe().clearTimeout(c),i(r)}r.ping(a).then(a,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Za=500,ec=600,tc="_blank",nc="http://localhost";class Ir{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rc(t,e,n,r=Za,i=ec){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const a=Object.assign(Object.assign({},Qa),{width:r.toString(),height:i.toString(),top:o,left:s}),u=ee().toLowerCase();n&&(c=fi(u)?tc:n),di(u)&&(e=e||nc,a.scrollbars="yes");const l=Object.entries(a).reduce((m,[h,v])=>`${m}${h}=${v},`,"");if($s(u)&&c!=="_self")return ic(e||"",c),new Ir(null);const d=window.open(e||"",c,l);I(d,t,"popup-blocked");try{d.focus()}catch{}return new Ir(d)}function ic(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oc="__/auth/handler",sc="emulator/auth/handler",ac=encodeURIComponent("fac");async function Tr(t,e,n,r,i,o){I(t.config.authDomain,t,"auth-domain-config-required"),I(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ht,eventId:i};if(e instanceof $n){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",ds(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[l,d]of Object.entries(o||{}))s[l]=d}if(e instanceof mt){const l=e.getScopes().filter(d=>d!=="");l.length>0&&(s.scopes=l.join(","))}t.tenantId&&(s.tid=t.tenantId);const c=s;for(const l of Object.keys(c))c[l]===void 0&&delete c[l];const a=await t._getAppCheckToken(),u=a?`#${ac}=${encodeURIComponent(a)}`:"";return`${cc(t)}?${pt(c).slice(1)}${u}`}function cc({config:t}){return t.emulator?Nn(t,sc):`https://${t.authDomain}/${oc}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="webStorageSupport";class uc{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ei,this._completeRedirectFn=Na,this._overrideRedirectResult=Aa}async _openPopup(e,n,r,i){var o;_e((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const s=await Tr(e,n,r,hn(),i);return rc(e,s,Mn())}async _openRedirect(e,n,r,i){await this._originValidation(e);const o=await Tr(e,n,r,hn(),i);return fa(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:o}=this.eventManagers[n];return i?Promise.resolve(i):(_e(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Ya(e),r=new xa(e);return n.register("authEvent",i=>(I(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(tn,{type:tn},i=>{var o;const s=(o=i==null?void 0:i[0])===null||o===void 0?void 0:o[tn];s!==void 0&&n(!!s),he(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=ja(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return vi()||Dn()||Ht()}}const lc=uc;var Sr="@firebase/auth",Er="1.5.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){I(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function hc(t){cr(new ur("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:c}=r.options;I(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const a={apiKey:s,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wi(t)},u=new Vs(r,i,o,a);return Js(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),cr(new ur("auth-internal",e=>{const n=Vt(e.getProvider("auth").getImmediate());return(r=>new dc(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),lr(Sr,Er,fc(t)),lr(Sr,Er,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc=5*60,gc=ei("authIdTokenMaxAge")||pc;let kr=null;const mc=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>gc)return;const i=n==null?void 0:n.token;kr!==i&&(kr=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Cr(t=ss()){const e=ni(t,"auth");if(e.isInitialized())return e.getImmediate();const n=zs(t,{popupRedirectResolver:lc,persistence:[_a,ua,Ei]}),r=ei("authTokenSyncURL");if(r){const o=mc(r);ia(n,o,()=>o(n.currentUser)),ra(n,s=>o(s))}const i=os("auth");return i&&Xs(n,`http://${i}`),n}hc("Browser");const vc={class:"border raduis-20 p-15"},wc=A("h2",{class:"text-30 text-center fw-bold-7 mb-15"},"Google 登入",-1),yc={class:"text-center"},bc={class:"mt-10"},_c=["src"],Ic={class:"mt-10"},Tc={key:1,class:"text-gray text-center"},Sc={__name:"GoogleLogin",setup(t){const e=rt({}),n=rt(""),r=rt("");An(async()=>{await s()});function i(){r.value=Cr();const c=new ae;console.log(r),console.log(c),ka(r.value,c).then(a=>{const u=ae.credentialFromResult(a);n.value=u.accessToken,e.value=JSON.parse(JSON.stringify(a.user)),console.log(`token: ${n.value}`),console.log(`user: ${JSON.stringify(a.user,null,2)}`),console.log(e.value)}).catch(a=>{const u=a.code,l=a.message,d=a.email,m=ae.credentialFromError(a);console.error(`errorMessage: ${l}`),console.error(`email: ${d}`),console.error(`errorCode: ${u}`),console.error(`credential: ${m}`)})}function o(){oa(r.value).then(()=>{console.log("登出成功！"),e.value={},n.value="",r.value=""}).catch(c=>{console.log(JSON.stringify(c))})}function s(){return new Promise((c,a)=>{let u=20;r.value=Cr(),l();function l(){setTimeout(async()=>{const{currentUser:d}=JSON.parse(JSON.stringify(r.value));d?(e.value=d,console.log(JSON.stringify(d,null,2)),c()):(u--,u>0&&l())},100)}})}return(c,a)=>(me(),ve("div",vc,[wc,A("div",yc,[A("button",{type:"button",class:"btn btn-primary",onClick:a[0]||(a[0]=u=>e.value.uid?o():i())},Ne(e.value.uid?"登出帳號":"登入 Google 帳號"),1)]),A("div",bc,[e.value.uid?(me(),ve(fs,{key:0},[A("p",null,[A("img",{src:e.value.photoURL,class:"rounded-pill",alt:"用戶頭像",width:"30"},null,8,_c),ut(" "+Ne(e.value.displayName),1)]),A("p",null,Ne(e.value.email),1),A("p",Ic,"上次登入時間為："+Ne(new Date(+e.value.lastLoginAt).toLocaleString()),1)],64)):(me(),ve("p",Tc,"尚未登入"))])]))}};var H=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},J={searchParams:"URLSearchParams"in H,iterable:"Symbol"in H&&"iterator"in Symbol,blob:"FileReader"in H&&"Blob"in H&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in H,arrayBuffer:"ArrayBuffer"in H};function Ec(t){return t&&DataView.prototype.isPrototypeOf(t)}if(J.arrayBuffer)var kc=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],Cc=ArrayBuffer.isView||function(t){return t&&kc.indexOf(Object.prototype.toString.call(t))>-1};function Ye(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||t==="")throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function jn(t){return typeof t!="string"&&(t=String(t)),t}function Bn(t){var e={next:function(){var n=t.shift();return{done:n===void 0,value:n}}};return J.iterable&&(e[Symbol.iterator]=function(){return e}),e}function W(t){this.map={},t instanceof W?t.forEach(function(e,n){this.append(n,e)},this):Array.isArray(t)?t.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}W.prototype.append=function(t,e){t=Ye(t),e=jn(e);var n=this.map[t];this.map[t]=n?n+", "+e:e};W.prototype.delete=function(t){delete this.map[Ye(t)]};W.prototype.get=function(t){return t=Ye(t),this.has(t)?this.map[t]:null};W.prototype.has=function(t){return this.map.hasOwnProperty(Ye(t))};W.prototype.set=function(t,e){this.map[Ye(t)]=jn(e)};W.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)};W.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),Bn(t)};W.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),Bn(t)};W.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),Bn(t)};J.iterable&&(W.prototype[Symbol.iterator]=W.prototype.entries);function nn(t){if(!t._noBody){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}}function Ni(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function Pc(t){var e=new FileReader,n=Ni(e);return e.readAsArrayBuffer(t),n}function Oc(t){var e=new FileReader,n=Ni(e),r=/charset=([A-Za-z0-9_-]+)/.exec(t.type),i=r?r[1]:"utf-8";return e.readAsText(t,i),n}function Ac(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function Pr(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function Ui(){return this.bodyUsed=!1,this._initBody=function(t){this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:J.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:J.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:J.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():J.arrayBuffer&&J.blob&&Ec(t)?(this._bodyArrayBuffer=Pr(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):J.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||Cc(t))?this._bodyArrayBuffer=Pr(t):this._bodyText=t=Object.prototype.toString.call(t):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):J.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},J.blob&&(this.blob=function(){var t=nn(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=nn(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(J.blob)return this.blob().then(Pc);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var t=nn(this);if(t)return t;if(this._bodyBlob)return Oc(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Ac(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},J.formData&&(this.formData=function(){return this.text().then(Nc)}),this.json=function(){return this.text().then(JSON.parse)},this}var Rc=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function Lc(t){var e=t.toUpperCase();return Rc.indexOf(e)>-1?e:t}function Me(t,e){if(!(this instanceof Me))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var n=e.body;if(t instanceof Me){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new W(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!n&&t._bodyInit!=null&&(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new W(e.headers)),this.method=Lc(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in H){var o=new AbortController;return o.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&n)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var i=/\?/;this.url+=(i.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Me.prototype.clone=function(){return new Me(this,{body:this._bodyInit})};function Nc(t){var e=new FormData;return t.trim().split("&").forEach(function(n){if(n){var r=n.split("="),i=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(o))}}),e}function Uc(t){var e=new W,n=t.replace(/\r?\n[\t ]+/g," ");return n.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var i=r.split(":"),o=i.shift().trim();if(o){var s=i.join(":").trim();try{e.append(o,s)}catch(c){console.warn("Response "+c.message)}}}),e}Ui.call(Me.prototype);function pe(t,e){if(!(this instanceof pe))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new W(e.headers),this.url=e.url||"",this._initBody(t)}Ui.call(pe.prototype);pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new W(this.headers),url:this.url})};pe.error=function(){var t=new pe(null,{status:200,statusText:""});return t.ok=!1,t.status=0,t.type="error",t};var xc=[301,302,303,307,308];pe.redirect=function(t,e){if(xc.indexOf(e)===-1)throw new RangeError("Invalid status code");return new pe(null,{status:e,headers:{location:t}})};var Re=H.DOMException;try{new Re}catch{Re=function(e,n){this.message=e,this.name=n;var r=Error(e);this.stack=r.stack},Re.prototype=Object.create(Error.prototype),Re.prototype.constructor=Re}function xi(t,e){return new Promise(function(n,r){var i=new Me(t,e);if(i.signal&&i.signal.aborted)return r(new Re("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}o.onload=function(){var u={statusText:o.statusText,headers:Uc(o.getAllResponseHeaders()||"")};i.url.indexOf("file://")===0&&(o.status<200||o.status>599)?u.status=200:u.status=o.status,u.url="responseURL"in o?o.responseURL:u.headers.get("X-Request-URL");var l="response"in o?o.response:o.responseText;setTimeout(function(){n(new pe(l,u))},0)},o.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},o.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},o.onabort=function(){setTimeout(function(){r(new Re("Aborted","AbortError"))},0)};function c(u){try{return u===""&&H.location.href?H.location.href:u}catch{return u}}if(o.open(i.method,c(i.url),!0),i.credentials==="include"?o.withCredentials=!0:i.credentials==="omit"&&(o.withCredentials=!1),"responseType"in o&&(J.blob?o.responseType="blob":J.arrayBuffer&&(o.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof W||H.Headers&&e.headers instanceof H.Headers)){var a=[];Object.getOwnPropertyNames(e.headers).forEach(function(u){a.push(Ye(u)),o.setRequestHeader(u,jn(e.headers[u]))}),i.headers.forEach(function(u,l){a.indexOf(l)===-1&&o.setRequestHeader(l,u)})}else i.headers.forEach(function(u,l){o.setRequestHeader(l,u)});i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){o.readyState===4&&i.signal.removeEventListener("abort",s)}),o.send(typeof i._bodyInit>"u"?null:i._bodyInit)})}xi.polyfill=!0;H.fetch||(H.fetch=xi,H.Headers=W,H.Request=Me,H.Response=pe);var Le;(function(t){t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR"})(Le||(Le={}));var Dc=function(){function t(e){e===void 0&&(e=Le.INFO),this.logLevel=e,this._debug=console.debug,this._info=console.info,this._warn=console.warn,this._error=console.error}return t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<=Le.DEBUG&&(e.unshift("[DEBUG]"),this._debug.apply(this,ce([],L(e),!1)))},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<=Le.INFO&&(e.unshift("[INFO]"),this._info.apply(this,ce([],L(e),!1)))},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<=Le.WARN&&(e.unshift("[WARN]"),this._warn.apply(this,ce([],L(e),!1)))},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.logLevel<=Le.ERROR&&(e.unshift("[ERROR]"),this._error.apply(this,ce([],L(e),!1)))},t}(),k=new Dc(+"3"),$c=function(t,e){this._driver=t,this.liff=e,this.hooks=this._driver.hooks,this.internalHooks=this._driver.internalHooks},Mc=function(t,e){this._driver=t,this.liff=e,this.hooks=this._driver.hooks},Fc=function(){function t(e,n){this.pluginCtx=new Mc(e,n),this.moduleCtx=new $c(e,n)}return Object.defineProperty(t.prototype,"pluginContext",{get:function(){return this.pluginCtx},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moduleContext",{get:function(){return this.moduleCtx},enumerable:!1,configurable:!0}),t}(),jc=function(){function t(){this.modules=new Map,this.hooks={},this.internalHooks={}}return t.prototype.addModule=function(e,n){this.modules.set(e,n),n.hooks&&(this.hooks[e]=Object.entries(n.hooks).reduce(function(r,i){var o,s=L(i,2),c=s[0],a=s[1];return R(R({},r),((o={})[c]=a.on.bind(a),o))},{})),"internalHooks"in n&&n.internalHooks&&(this.internalHooks[e]=Object.entries(n.internalHooks).reduce(function(r,i){var o,s=L(i,2),c=s[0],a=s[1];return R(R({},r),((o={})[c]=a.on.bind(a),o))},{}))},t.prototype.hasModule=function(e){return this.modules.has(e)},t}(),T=function(){},Or=function(t){return t instanceof T},Di=function(t){function e(n,r,i){var o=t.call(this)||this;return o.driver=n,o.contextHolder=r,o.option=i,o}return S(e,t),e.prototype.install=function(){return this.factory(this.driver,this.contextHolder)},Object.defineProperty(e.prototype,"name",{get:function(){return"use"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOption",{get:function(){return{namespacePrefix:"$"}},enumerable:!1,configurable:!0}),e.prototype.factory=function(n,r){var i=Object.assign({},this.defaultOption,this.option).namespacePrefix;return function(o,s){if(!o||typeof o.install!="function"||typeof o.name!="string")return k.warn("To install the plugin, you need to define the `name` property and the `install` method."),this;var c=Or(o)?o.name:"".concat(i).concat(o.name);if(n.hasModule(c))return this;var a=Or(o)?o.install.call(o,r.moduleContext,s):o.install.call(o,r.pluginContext,s);return this["".concat(c)]?(k.warn("There is a duplicate plugin name. `".concat(c,"` plugin namespace will be override.")),this["".concat(c)]=a):a!==void 0&&(this["".concat(c)]=a),n.addModule(c,o),this}},e}(T),$i,Bc=new Promise(function(t){$i=t}),Z="UNKNOWN",V="UNAUTHORIZED",N="INVALID_ARGUMENT",M="INIT_FAILED",O="FORBIDDEN",ge="INVALID_CONFIG",Ae="INVALID_ID_TOKEN",gn="CREATE_SUBWINDOW_FAILED",mn="EXCEPTION_IN_SUBWINDOW",Mi="liffEvent",le="LIFF_STORE",Mt="https://liff.".concat("line.me","/"),vn="https://miniapp.".concat("line.me","/"),E={ACCESS_TOKEN:"accessToken",ID_TOKEN:"IDToken",DECODED_ID_TOKEN:"decodedIDToken",FEATURE_TOKEN:"featureToken",LOGIN_TMP:"loginTmp",CONFIG:"config",CONTEXT:"context",EXPIRES:"expires",RAW_CONTEXT:"rawContext",CLIENT_ID:"clientId",IS_SUBSEQUENT_LIFF_APP:"isSubsequentLiffApp",MST_CHALLENGE:"mstChallenge",MSIT:"msit",MST:"mst",MST_VERIFIER:"mstVerifier",APP_DATA:"appData"},Ar="isInClient",Wn=["context_token","feature_token","access_token","id_token","client_id","mst_verifier","mst_challenge","msit"],Wc=5,Hc=["liff.ref.source","liff.ref.medium","liff.ref.campaign","liff.ref.term","liff.ref.content"],Vc="liff://subwindow",P={INIT:"init",SUBMIT:"submit",CANCEL:"cancel",CLOSE:"close",ERROR:"error"},Gc=100,Fi=100,ji="liff.subwindow",Ft="healthCheck",Kc=["profile","chat_message.write","openid","email"];function Rr(t){return window.atob(t.replace(/-/g,"+").replace(/_/g,"/"))}var rn={decode:Rr,encode:function(t){return window.btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decodeUnicode:function(t){var e=Rr(t).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join("");return decodeURIComponent(e)}};function ue(t,e){if(t===e)return 0;for(var n=t.split("."),r=e.split("."),i=Math.max(n.length,r.length),o=0;o<i;o++){n[o]||(n[o]="0"),r[o]||(r[o]="0");var s=parseInt(n[o])-parseInt(r[o]);if(s!==0)return s>0?1:-1}return 0}function Lr(t){var e=t.replace("#","").match(/.{2}/g)||[];if(e.length!==4)return k.warn("convertArgbToRgba: Received invalid ARGB color"),"";var n=function(s){var c=xe(s);return Math.round(c/255*100)/100}(e[0]),r=xe(e[1]),i=xe(e[2]),o=xe(e[3]);return"rgba(".concat(r,", ").concat(i,", ").concat(o,", ").concat(n,")")}function xe(t){return parseInt(t,16)}function Nr(t){var e=t.replace("#","").match(/.{2}/g)||[];if(e.length!==3)return k.warn("convertArgbToRgba: Received invalid hex color"),"";var n=xe(e[0]),r=xe(e[1]),i=xe(e[2]);return"".concat(n,", ").concat(r,", ").concat(i)}function Ur(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}var Hn={get:function(t){var e=new RegExp("(?:(?:^|.*;\\s*)".concat(t,"\\s*\\=\\s*([^;]*).*$)|^.*$"));return document.cookie.replace(e,"$1")},set:function(t,e,n){var r=t+"="+e;if(n)for(var i in n){var o=n[i]?"=".concat(n[i]):"";r+="; ".concat(i).concat(o)}k.debug("set cookie",r),document.cookie=r},remove:function(t,e){var n="".concat(t,"=; expires=Thu, 01 Jan 1970 00:00:00 GMT");if(e)for(var r in e)n+="; ".concat(r,"=").concat(e[r]);document.cookie=n}},qc=new Set(["400","401","403","404","429","500"]),Bi=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i}return S(e,t),e}(Error);function f(t,e){return new Bi(t,e||"")}function Vn(t){var e=t.match(/([^-]+)-[^-]+/);return e&&e[1]}function zc(t){var e="";return t.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").forEach(function(n){e+=String.fromCharCode(parseInt(n))}),window.btoa(e)}var Wi=function(){function t(){this.map={}}return t.prototype.clear=function(){this.map={}},t.prototype.getItem=function(e){var n=this.map[e];return n===void 0?null:n},t.prototype.setItem=function(e,n){this.map[e]=n},t.prototype.removeItem=function(e){delete this.map[e]},t.prototype.key=function(e){var n=Object.keys(this.map)[e];return n===void 0?null:n},Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.map).length},enumerable:!1,configurable:!0}),t}(),on,q={parse:function(t){return t.replace(/^\?/,"").replace(/^#\/?/,"").split(/&+/).filter(function(e){return e.length>0}).reduce(function(e,n){var r=L(n.split("=").map(decodeURIComponent),2),i=r[0],o=r[1],s=e[i];return Array.isArray(s)?s.push(o):Object.prototype.hasOwnProperty.call(e,i)?e[i]=[s,o]:e[i]=o,e},{})},stringify:function(t){return Object.keys(t).map(function(e){var n=t[e],r=function(i){return i!==void 0?"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(i)):encodeURIComponent(e)};return Array.isArray(n)?n.map(function(i){return r(i)}).join("&"):r(n)}).join("&")}},xr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function Jc(){return window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}function ze(t){for(var e="",n=0;n<t;n++)e+=xr[Math.floor(Jc()*xr.length)];return e}function Hi(t){var e=new URL(t),n=e.hash.slice(1).split("&").filter(function(r){return!Wn.some(function(i){return r.includes("".concat(i,"="))})}).join("&");return e.hash=n,e.toString()}function Xc(t){var e=new URL(t);return e.toString().replace(new RegExp(String.raw(Dr||(Dr=gs(["^",""],["^",""])),e.origin)),"")}var Yc=function(t){var e=Xc(Hi(t));window.history.replaceState(history.state,"",e)};function ft(t,e){if(!t)throw new Error("addParamsToUrl: invalid URL");var n=new URL(t);return Object.entries(e).forEach(function(r){var i=L(r,2),o=i[0],s=i[1];n.searchParams.set(o,s)}),n.toString()}var Dr,$r=((on={})[Mt]=function(){var t=Mr(Mt);return new RegExp("^".concat(t,"(\\d+-\\w+)"))},on[vn]=function(){var t=Mr(vn);return new RegExp("^".concat(t,"((\\d+-\\w+)|(\\w+$))"))},on);function Gn(t){for(var e in $r){var n=t.match($r[e]());if(n)return n[1]}return null}function Mr(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Qc(t){var e=t.match(/^(https?:\/\/.*?)\//);return e&&e[1]||""}function wn(t){return t.startsWith("line:")}function Kn(t){return t===void 0&&(t=window.navigator.userAgent),/ipad/.test(t.toLowerCase())}function Vi(t){return t===void 0&&(t=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+/.test(t)}function Gi(t){return t===void 0&&(t=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+ LIFF/.test(t)}function Zc(t){return t===void 0&&(t=window.navigator.userAgent),/LIFF\/SubWindow/.test(t)}var Ki=function(){return typeof window>"u"},Tt=null;function C(){return Tt===null&&(Tt=Gi()||Vi()&&/[#|&]access_token=/.test(location.hash)||sessionStorage.getItem("".concat(le,":").concat(Ar))==="1",sessionStorage.setItem("".concat(le,":").concat(Ar),Tt?"1":"0")),!!Tt}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"isInClient"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return C()}},e})(T);function D(){var t;return(t=window.__liffConfig)!==null&&t!==void 0?t:{}}function eu(t){window.__liffConfig=t}function tu(t,e){if(!e)throw f(ge,"liffId is necessary for liff.init()");var n=(C()?sessionStorage:localStorage).getItem("".concat(le,":").concat(e,":").concat(t));try{return n===null?null:JSON.parse(n)}catch{return null}}function te(t){return tu(t,D().liffId)}function re(t,e){var n=D().liffId;if(!n)throw f(ge,"liffId is necessary for liff.init()");(C()?sessionStorage:localStorage).setItem("".concat(le,":").concat(n,":").concat(t),JSON.stringify(e))}function G(){return te(E.CONTEXT)}function qn(t){re(E.CONTEXT,t)}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getContext"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return G()}},e})(T);function qi(){return((G()||{}).d||{}).aId}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getAId"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return qi()}},e})(T);function zi(){return((G()||{}).d||{}).autoplay||!1}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getIsVideoAutoPlay"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return zi()}},e})(T);function Ji(){return(G()||{}).profilePlus}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getProfilePlus"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Ji()}},e})(T);function nu(){return!!te(E.IS_SUBSEQUENT_LIFF_APP)}function ru(t){re(E.IS_SUBSEQUENT_LIFF_APP,t)}function iu(){return te(E.APP_DATA)}function yn(t){re(E.APP_DATA,t)}function ou(){return te(E.MST_VERIFIER)}function su(t){re(E.MST_VERIFIER,t)}function au(){return te(E.MSIT)}function cu(t){re(E.MSIT,t)}function qt(){return te(E.MST)}function uu(t){re(E.MST,t)}function Xi(){return te(E.MST_CHALLENGE)}function lu(t){re(E.MST_CHALLENGE,t)}function du(){return te(E.CLIENT_ID)}function Yi(t){re(E.CLIENT_ID,t)}function fu(){return te(E.RAW_CONTEXT)}function wt(){return te(E.FEATURE_TOKEN)}function Fr(t){re(E.FEATURE_TOKEN,t)}function zt(){return te(E.ID_TOKEN)}function Qi(t){re(E.ID_TOKEN,t)}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getIDToken"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return zt()}},e})(T);function Ie(){return te(E.ACCESS_TOKEN)}function zn(t){re(E.ACCESS_TOKEN,t)}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getAccessToken"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Ie()}},e})(T);function Zi(t){var e=D().liffId;if(!e)throw f(ge,"liffId is necessary for liff.init()");(C()?sessionStorage:localStorage).removeItem("".concat(le,":").concat(e,":").concat(t))}function eo(){return te(E.LOGIN_TMP)}function hu(t){re(E.LOGIN_TMP,t)}function jr(){Zi(E.LOGIN_TMP)}function to(t){var e=D();Hn.set("".concat(le,":").concat(E.EXPIRES,":").concat(e.liffId),t.getTime(),{expires:t.toUTCString(),path:"/",secure:null})}function pu(){var t=D();return Hn.get("".concat(le,":").concat(E.EXPIRES,":").concat(t.liffId))}function gu(){var t=D();Hn.remove("".concat(le,":").concat(E.EXPIRES,":").concat(t.liffId),{path:"/"})}function Jt(){return te(E.DECODED_ID_TOKEN)}function no(t){re(E.DECODED_ID_TOKEN,t)}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getDecodedIDToken"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Jt()}},e})(T);function mu(){Object.keys(E).forEach(function(t){Zi(E[t])}),gu()}function z(){return!!Ie()}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"isLoggedIn"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return z()}},e})(T);function Xt(){return"2.23.0"}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getVersion"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return"2.23.0"}},e})(T);var vu=function(){function t(){}return t.prototype.invoke=function(){return Zc()},t}(),wu=function(){function t(e){this.storage=e}return Object.defineProperty(t,"IN_SUB_WINDOW_KEY",{get:function(){return"inSubWindow"},enumerable:!1,configurable:!0}),t.prototype.invoke=function(){return new URLSearchParams(window.location.search).has(ji)&&this.setInSubWindow(!0),!(!this.getInSubWindow()&&!this.getSubWindowIdentifier())},t.prototype.getInSubWindow=function(){var e=this.storage.getItem("".concat(le,":").concat(this.getLiffId(),":").concat(t.IN_SUB_WINDOW_KEY));return e!==null&&JSON.parse(e)},t.prototype.getSubWindowIdentifier=function(){var e,n,r="liff.subwindow.identifier",i=new URLSearchParams(window.location.search);return i.get(r)||(e=r,(n=i.get("liff.state"))?new URLSearchParams(n).get(e):null)||null},t.prototype.setInSubWindow=function(e){this.storage.setItem("".concat(le,":").concat(this.getLiffId(),":").concat(t.IN_SUB_WINDOW_KEY),String(e))},t.prototype.getLiffId=function(){var e=D().liffId;if(!e)throw f(ge,"liffId is necessary for liff.init()");return e},t}(),yu=function(t){function e(){var n=t.call(this)||this;return Ki()?n.impl={invoke:function(){return!1}}:C()?n.impl=new vu:n.impl=new wu(window.sessionStorage),n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"isSubWindow"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return this.impl.invoke.bind(this.impl)},e}(T),ro=new yu,be=ro.install();function Te(){var t=navigator.userAgent.match(/Line\/\d+(\.\d+)*/i);return t?t[0].slice(5):null}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getLineVersion"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Te()}},e})(T);var sn;function X(){if(!sn){var t=window.navigator.userAgent.toLowerCase();sn=/iphone|ipad|ipod/.test(t)?"ios":/android/.test(t)?"android":"web"}return sn}(function(t){function e(){return t.call(this)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getOS"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return X()}},e})(T);function io(t){var e,n=G();return(e=n==null?void 0:n.availability)===null||e===void 0?void 0:e[t]}function se(t,e,n){var r=io(t),i=n||t;if(!r||!r.permission)return{available:!1,error:{code:O,message:"".concat(i," is not allowed in this LIFF app")}};var o=r.minVer,s=r.unsupportedFromVer;if(C()){var c=function(a,u){var l=Te();return!!l&&!(u&&ue(l,u)>0)&&ue(l,a)>=0}(o,s);return c?{available:!0}:{available:!1,error:{code:O,message:"".concat(i," is unavailable in this client version.")}}}return e?{available:!0}:{available:!1,error:{code:O,message:"".concat(i," is not allowed in external browser")}}}var Br=function(){return z()?!Gi()&&Vi()?{available:!1,error:{code:O,message:"Subwindow is not supported in this browser"}}:be()?{available:!1,error:{code:O,message:"this api can be only called in parent window"}}:se("subwindowOpen",!0):{available:!1,error:{code:V,message:"Need access_token for api call, Please login first"}}},bu=["subwindowOpen","shareTargetPicker","multipleLiffTransition","scanCode","scanCodeV2","getAdvertisingId","addToHomeScreen","bluetoothLeFunction","skipChannelVerificationScreen","createShortcutOnHomeScreen","internalCreateShortcutOnHomeScreen"],ie={scanCode:function(){return se("scanCode")},getAdvertisingId:function(){return se("getAdvertisingId")},bluetoothLeFunction:function(){return se("bluetoothLeFunction")},shareTargetPicker:function(){return be()?{available:!1,error:{code:O,message:"this api can be only called in parent window"}}:z()?se("shareTargetPicker",!0):{available:!1,error:{code:V,message:"Need access_token for api call, Please login first"}}},multipleLiffTransition:function(){var t=io("multipleLiffTransition");return t&&t.permission?C()?{available:!0}:{available:!1,error:{code:O,message:"multipleLiffTransition is available only in the LINE App browser"}}:{available:!1,error:{code:O,message:"multipleLiffTransition is not allowed in this LIFF app"}}},subwindowOpen:Br,scanCodeV2:function(){if(!z())return{available:!1,error:{code:V,message:"Need access_token for api call, Please login first"}};var t=Br();return t.available?se("scanCodeV2",!0):t},addToHomeScreen:function(){return be()?{available:!1,error:{code:O,message:"this api can be only called in parent window"}}:se("addToHomeScreen")},skipChannelVerificationScreen:function(){var t=G();return t?t.type==="square_chat"?{available:!1,error:{code:O,message:"skipChannelVerificationScreen is not allowed in OpenChat"}}:se("skipChannelVerificationScreen"):{available:!1,error:{code:O,message:"Context is not found"}}},createShortcutOnHomeScreen:function(){if(be())return{available:!1,error:{code:O,message:"this api can be only called in parent window"}};if(!z())return{available:!1,error:{code:V,message:"Need access_token for api call, Please login first"}};var t=X();return t!=="android"&&t!=="ios"?{available:!1,error:{code:O,message:"this api can be only called in mobile device"}}:se("addToHomeV2",!0,"createShortcutOnHomeScreen")},internalCreateShortcutOnHomeScreen:function(){if(be())return{available:!1,error:{code:O,message:"this api can be only called in parent window"}};if(!z())return{available:!1,error:{code:V,message:"Need access_token for api call, Please login first"}};var t=X();if(t!=="android"&&t!=="ios")return{available:!1,error:{code:O,message:"this api can be only called in mobile device"}};var e=se("addToHomeV2",!0,"internalCreateShortcutOnHomeScreen");return e.available?se("addToHomeLineScheme",!0,"internalCreateShortcutOnHomeScreen"):e}},oe=function(t){return function(){var e=t();if(!e.available)throw f(e.error.code,e.error.message)}},Qe={scanCode:oe(ie.scanCode),getAdvertisingId:oe(ie.getAdvertisingId),bluetoothLeFunction:oe(ie.bluetoothLeFunction),shareTargetPicker:oe(ie.shareTargetPicker),multipleLiffTransition:oe(ie.multipleLiffTransition),subwindowOpen:oe(ie.subwindowOpen),scanCodeV2:oe(ie.scanCodeV2),addToHomeScreen:oe(ie.addToHomeScreen),skipChannelVerificationScreen:oe(ie.skipChannelVerificationScreen),createShortcutOnHomeScreen:oe(ie.createShortcutOnHomeScreen),internalCreateShortcutOnHomeScreen:oe(ie.internalCreateShortcutOnHomeScreen)};function yt(t){if(!function(n){return bu.some(function(r){return r===n})}(t))throw f(N,"Unexpected API name.");var e=ie[t];return!e||e().available}(function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.hooks={},n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"isApiAvailable"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(n){return yt(n)}},e})(T);var _u=function(){function t(){}return t.prototype.invoke=function(e){var n=Qe[e];return!!n&&(n(),!0)},t}(),Iu=function(){function t(e){this.liff=e}return t.prototype.invoke=function(e){return this.liff.checkFeature(e)},t}(),an=function(){function t(e){ue(Xt(),t.SDK_VERSION_SUPPORTING_NEW)>=0?this.impl=new _u:this.impl=new Iu(e)}return Object.defineProperty(t,"SDK_VERSION_SUPPORTING_NEW",{get:function(){return"2.11.0"},enumerable:!1,configurable:!0}),t.prototype.invoke=function(e){return this.impl.invoke(e)},t}(),bn=function(t,e){return bn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},bn(t,e)};function Tu(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(u){try{a(r.next(u))}catch(l){o(l)}}function c(u){try{a(r.throw(u))}catch(l){o(l)}}function a(u){var l;u.done?i(u.value):(l=u.value,l instanceof n?l:new n(function(d){d(l)})).then(s,c)}a((r=r.apply(t,e||[])).next())})}function Su(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(a){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&l[0]?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[2&l[0],i.value]),l[0]){case 0:case 1:i=l;break;case 4:return s.label++,{value:l[1],done:!1};case 5:s.label++,r=l[1],l=[0];continue;case 7:l=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||l[0]!==6&&l[0]!==2)){s=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){s.label=l[1];break}if(l[0]===6&&s.label<i[1]){s.label=i[1],i=l;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(l);break}i[2]&&s.ops.pop(),s.trys.pop();continue}l=e.call(t,s)}catch(d){l=[6,d],r=0}finally{n=i=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([a,u])}}}var oo=!1,Eu=function(){return oo},ku=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return function(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=n}bn(n,r),n.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"_legacyExtensionsEnabled"},enumerable:!1,configurable:!0}),e.prototype.install=function(){oo=!0},e}(T);function Cu(){var t;return X()==="ios"?(t=Te())&&ue(t,"9.19.0")<0?"https://static.line-scdn.net/liff/edge/2/ios-918-extensions_2_22_0.js":"https://static.line-scdn.net/liff/edge/2/ios-extensions_2_22_0.js":"https://static.line-scdn.net/liff/edge/2/non-ios-extensions_2_22_0.js"}function Pu(){return Eu()?function(){return Tu(this,void 0,void 0,function(){return Su(this,function(t){switch(t.label){case 0:return[3,2];case 1:return[2,t.sent().default];case 2:return[2,new Promise(function(e,n){var r=document.createElement("script"),i=Cu();r.onload=function(){var o=window.liffClientExtension;o?e(o):n(f(M,"Unable to load client features. (Extension is empty)"))},r.onerror=function(){n(f(M,"Unable to load client features."))},r.src=i,r.type="text/javascript",document.body.appendChild(r)})]}})})}():Promise.resolve(void 0)}function Jn(){mu()}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"logout"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Jn()}},e})(T);function Ou(t){return p(this,void 0,void 0,function(){var e,n,r;return g(this,function(i){switch(i.label){case 0:if(!t.ok)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.json()];case 2:return[2,i.sent()];case 3:return i.sent(),[2,t];case 4:return e=String(t.status),n=qc.has(e)?e:Z,[4,t.json().catch(function(){throw f(n,t.statusText)})];case 5:throw r=i.sent(),f(r.error||n,r.error_description||r.message)}})})}function so(t){var e=function(n){if(n)return n;var r=Ie();if(!r)throw f(V,"Need access_token for api call, Please login first");return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(r)}}(t&&t.headers);return R(R({},t),{headers:e})}function F(t,e){var n;try{n=so(e)}catch(r){return Promise.reject(r)}return fetch(t,n).then(Ou)}function Au(t,e){var n;try{n=so(e)}catch(r){return Promise.reject(r)}return fetch(t,n)}function $(t){var e=t.subdomain,n=e===void 0?"api":e,r=t.pathname;return"https://".concat(n,".").concat("line.me","/").concat(r)}var Ru={token:$({pathname:"oauth2/v2.1/token"}),certs:$({pathname:"oauth2/v2.1/certs"}),"openid-configuration":$({subdomain:"access",pathname:".well-known/openid-configuration"}),authorize:$({subdomain:"access",pathname:"liff/v1/authorize"}),profile:$({pathname:"v2/profile"}),message:$({pathname:"message/v3/share"}),friendship:$({pathname:"friendship/v1/status"}),shareTargetPicker:$({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker"}),shareTargetPickerOtt:$({pathname:"liff/v2/apps"}),shareTargetPickerResult:$({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker/result"}),apps:$({pathname:"liff/v2/apps"}),subWindowGetMSIT:$({pathname:"liff/v2/sub/msit"}),subWindowGetMSTByMSIT:$({pathname:"liff/v2/sub/mst"}),subWindowSubscribe:$({subdomain:"liff",pathname:"liff/v2/sub/waitResult"}),subWindowPost:$({pathname:"liff/v2/sub/result"}),subWindowGetAppData:$({pathname:"liff/v2/sub/appData"}),subWindowGetOrigin:function(t){return $({pathname:"liff/v2/sub/".concat(t,"/origin")})},accessTokenVerify:$({pathname:"oauth2/v2.1/verify"}),unauthorizedPermissions:$({subdomain:"liff",pathname:"liff/v2/incrementalAgreement/unauthorizedPermissions"}),permanentLink:$({subdomain:"liff",pathname:"liff/v2/permanentLink"}),createShortcutOnHomeScreen:$({subdomain:"liff-shortcut",pathname:"api/shortcut"})};function x(t){return Ru[t]}function ao(t){return F("".concat(x("accessTokenVerify"),"?access_token=").concat(encodeURIComponent(t)),{headers:{"Content-Type":"application/json",Accept:"application/json"}})}var co="liff.subwindow.identifier",_n="liff.subwindow.cryptokey",At=R(R({},P),{GET_DATA:"getData",SET_DATA:"setData",NOT_FOUND:"notFound",TEARDOWN:"teardown"}),jt={BROADCAST:"broadcast",COMMAND:"command"},ot={MAIN:"main",SUB:"sub"},uo=function(t){return p(void 0,void 0,void 0,function(){var e;return g(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,window.crypto.subtle.importKey("jwk",{kty:"oct",k:t,alg:"A128GCM",ext:!0},{name:"AES-GCM"},!1,["encrypt","decrypt"])];case 1:return[2,n.sent()];case 2:throw e=n.sent(),f(Z,e);case 3:return[2]}})})},Lu=function(t,e,n){return p(void 0,void 0,void 0,function(){var r,i,o,s;return g(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),r=new TextEncoder().encode(t),[4,uo(e)];case 1:return i=c.sent(),[4,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},i,new TextEncoder().encode(n))];case 2:return o=c.sent(),[2,btoa(new Uint8Array(o).reduce(function(a,u){return a+String.fromCharCode(u)},""))];case 3:throw s=c.sent(),f(Z,s);case 4:return[2]}})})},Nu=function(t,e,n){return p(void 0,void 0,void 0,function(){var r,i,o,s,c,a,u;return g(this,function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),r=new TextEncoder().encode(t),[4,uo(e)];case 1:for(i=l.sent(),o=atob(n),s=new Uint8Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);return[4,window.crypto.subtle.decrypt({name:"AES-GCM",iv:r},i,s.buffer)];case 2:return a=l.sent(),[2,new TextDecoder().decode(new Uint8Array(a))];case 3:throw u=l.sent(),f(Z,u);case 4:return[2]}})})},Uu=function(t,e){return st(t)===st(e)},st=function(t){return"".concat(t.identifier,"-").concat(t.action,"-").concat(t.timestamp)},xu=function(t){return Object.keys(P).map(function(e){return P[e]}).includes(t)?jt.BROADCAST:jt.COMMAND};function Du(){var t=document.createElement("form");t.method="POST",t.action="$MESSAGE_HANDLER_URL";var e=document.createElement("input");e.type="hidden",e.name="identifier",e.value="$IDENTIFIER",t.appendChild(e),document.body.appendChild(t),t.submit()}var $u=function(t){t===void 0&&(t=ot.MAIN);var e=this;this.identification={identifier:"",cryptoKey:""},this.messageHandlerInstance=null,this.listeners=new Map,this.sentMessages=[],this.generateIdentification=function(){return p(e,void 0,void 0,function(){var n,r,i,o,s;return g(this,function(c){switch(c.label){case 0:return n=new URLSearchParams(window.location.search),r=function(a){var u=n.get("liff.state");return u?new URLSearchParams(u).get(a):null},i=this,s={identifier:this.windowType===ot.MAIN?ze(12):n.get("liff.subwindow.identifier")||r("liff.subwindow.identifier")||""},this.windowType!==ot.MAIN?[3,2]:[4,p(void 0,void 0,void 0,function(){var a,u,l;return g(this,function(d){switch(d.label){case 0:return d.trys.push([0,3,,4]),[4,window.crypto.subtle.generateKey({name:"AES-GCM",length:128},!0,["encrypt","decrypt"])];case 1:return a=d.sent(),[4,window.crypto.subtle.exportKey("jwk",a)];case 2:if(!(u=d.sent())||!u.k)throw f(Z,"failed to generate key");return[2,u.k];case 3:throw l=d.sent(),f(Z,l);case 4:return[2]}})})];case 1:return o=c.sent(),[3,3];case 2:o=n.get(_n)||r(_n)||"",c.label=3;case 3:return i.identification=(s.cryptoKey=o,s),[2]}})})},this.hasIdentification=function(){var n=e.identification,r=n.identifier,i=n.cryptoKey;return typeof r=="string"&&typeof i=="string"&&r.length>0&&i.length>0},this.isReady=function(){return e.hasIdentification()&&!!e.messageHandlerInstance},this.setup=function(){return p(e,void 0,void 0,function(){var n,r,i,o,s,c=this;return g(this,function(a){switch(a.label){case 0:return this.messageHandlerInstance?[2]:[4,this.generateIdentification()];case 1:if(a.sent(),!(n=this.identification.identifier))return[2];if(r=/^[a-zA-Z0-9]+$/gm,!n.match(r))throw f(Z,"Invalid identifier");return(i=document.createElement("iframe")).style.display="none",i.src="about:blank",document.body.appendChild(i),(s=i==null?void 0:i.contentWindow)===null||s===void 0||s.window.eval("(".concat(Du.toString().replace("$MESSAGE_HANDLER_URL","".concat("https://liff-subwindow.line.me/liff/v2/sub/messageHandler")).replace("$IDENTIFIER",n.split("'")[0]),")()")),o="iframe-".concat(n,"-ready"),[4,new Promise(function(u){var l=function(d){d.data[o]&&(c.messageHandlerInstance=i,window.addEventListener("message",c.proxyToListeners),u(),document.removeEventListener("message",l))};window.addEventListener("message",l)})];case 2:return[2,a.sent()]}})})},this.teardown=function(){return p(e,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return this.isReady()?[4,this.send({eventName:At.TEARDOWN})]:[3,2];case 1:i.sent(),window.removeEventListener("message",this.proxyToListeners),this.listeners.clear(),(r=(n=this.messageHandlerInstance)===null||n===void 0?void 0:n.parentNode)===null||r===void 0||r.removeChild(this.messageHandlerInstance),this.messageHandlerInstance=null,i.label=2;case 2:return[2]}})})},this.listen=function(n){e.listeners.set(n,n)},this.listenRepliedEvent=function(n,r){var i=function(o){o.replyTarget&&Uu(o.replyTarget,n)&&(r(o),e.listeners.delete(i))};e.listeners.set(i,i)},this.send=function(n){return p(e,void 0,void 0,function(){var r,i,o,s,c=this;return g(this,function(a){switch(a.label){case 0:if(!this.isReady())throw f("message bus is not ready to send message");return i={action:xu(n.eventName),identifier:this.identification.identifier||"",timestamp:new Date().getTime()},[4,this.getEncryptedContext(n)];case 1:return i.context=a.sent(),r=i,(s=(o=this.messageHandlerInstance)===null||o===void 0?void 0:o.contentWindow)===null||s===void 0||s.postMessage({messageBusEvent:r},"*"),this.sentMessages.push(st(r)),[4,new Promise(function(u){c.listenRepliedEvent(r,function(l){u(l.context)})})];case 2:return[2,a.sent()]}})})},this.reply=function(n,r){return p(e,void 0,void 0,function(){var i,o,s,c;return g(this,function(a){switch(a.label){case 0:if(!this.isReady())throw f("message bus is not ready to send message");if(!n.identifier||!n.timestamp)throw f(Z,"target message is not valid");return o={action:jt.BROADCAST},[4,this.getEncryptedContext(r)];case 1:return o.context=a.sent(),o.identifier=this.identification.identifier||"",o.timestamp=new Date().getTime(),o.replyTarget={action:n.action,identifier:n.identifier,timestamp:n.timestamp},i=o,(c=(s=this.messageHandlerInstance)===null||s===void 0?void 0:s.contentWindow)===null||c===void 0||c.postMessage({messageBusEvent:i},"*"),this.sentMessages.push(st(i)),[2]}})})},this.setData=function(n,r){n===void 0&&(n="appData"),e.send({eventName:At.SET_DATA,key:n,data:r})},this.getData=function(n){return n===void 0&&(n="appData"),p(e,void 0,void 0,function(){return g(this,function(r){switch(r.label){case 0:return[4,this.send({eventName:At.GET_DATA,key:n})];case 1:return[2,r.sent()]}})})},this.proxyToListeners=function(n){return p(e,void 0,void 0,function(){var r,i=this;return g(this,function(o){return(r=n.data.messageBusEvent)?(this.sentMessages.includes(st(r))||r.identifier!==this.identification.identifier||r.action!==jt.BROADCAST&&!r.replyTarget||this.listeners.forEach(function(s){return p(i,void 0,void 0,function(){var c,a,u;return g(this,function(l){switch(l.label){case 0:return c=s,a=[R({},r)],u={},[4,this.getDecryptedContext(r.context)];case 1:return c.apply(void 0,[R.apply(void 0,a.concat([(u.context=l.sent(),u)]))]),[2]}})})}),[2]):[2]})})},this.getEncryptedContext=function(n){return p(e,void 0,void 0,function(){var r,i,o,s,c,a,u;return g(this,function(l){switch(l.label){case 0:return r=this.identification,i=r.identifier,o=r.cryptoKey,c=(s=JSON).stringify,u={eventName:n.eventName,key:n.key?n.key:void 0},n.data?[4,Lu(i,o,JSON.stringify(n.data))]:[3,2];case 1:return a=l.sent(),[3,3];case 2:a=void 0,l.label=3;case 3:return[2,c.apply(s,[(u.data=a,u)])]}})})},this.getDecryptedContext=function(n){return p(e,void 0,void 0,function(){var r,i,o,s,c,a,u,l;return g(this,function(d){switch(d.label){case 0:return r=this.identification,i=r.identifier,o=r.cryptoKey,(s=JSON.parse(n)).data&&typeof s.data=="string"?(l=(u=JSON).parse,[4,Nu(i,o,s.data)]):[3,2];case 1:return a=l.apply(u,[d.sent()]),[3,3];case 2:a=void 0,d.label=3;case 3:return c=a,[2,R(R({},s),{data:c})]}})})},this.windowType=t};function Mu(t){return new CustomEvent(Mi,{detail:t})}(function(){if(typeof window<"u"&&typeof window.CustomEvent!="function"){let t=function(e,n){var r=n||{},i=r.bubbles,o=i!==void 0&&i,s=r.cancelable,c=s!==void 0&&s,a=r.detail,u=a===void 0?void 0:a,l=document.createEvent("CustomEvent");return l.initCustomEvent(e,o,c,u),l};t.prototype=Event.prototype,window.CustomEvent=t}})();var Be={},Wr=!1;function Xn(t,e){Wr||(Wr=!0,window.addEventListener(Mi,function(n){n&&n.detail&&n.detail.type&&Be[n.detail.type]&&Be[n.detail.type].forEach(function(r){return r(n)})})),Be[t]?Be[t].push(e):Be[t]=[e]}function Yn(t,e){var n=Be[t];if(n&&Array.isArray(n)){var r=n.indexOf(e);r>=0&&n.splice(r,1)}}function Fu(t){var e={};try{e=JSON.parse(t)}catch(r){throw f(N,r.message)}var n=Mu(e);k.debug("[client dispatchEvent to js]",{type:n.type,detail:n.detail}),window.dispatchEvent(n)}function lo(t,e,n){e===void 0&&(e={}),n===void 0&&(n="");var r=wt();if(!r)throw f(O,"Invalid featureToken for client features");if(!window._liff||!window._liff.postMessage)throw f(N,"postMessage is not available from client");k.debug("[js postMessage to client]",t,n,e),window._liff.postMessage(t,r,n,JSON.stringify(e))}function Qn(t,e,n){return e===void 0&&(e={}),n===void 0&&(n={once:!0}),wt()?(n=R({callbackId:ze(12),once:!0},n),new Promise(function(r,i){var o=function(s){if(s&&s.detail){var c=s.detail.callbackId===n.callbackId,a=typeof s.detail.callbackId!="string";(c||a)&&(n.once&&Yn(t,o),k.debug("[callback detail]",s.detail),s.detail.error?i(s.detail.error):s.detail.data?r(s.detail.data):i(s.detail))}i()};Xn(t,o),lo(t,e,n.callbackId)})):Promise.reject(f(O,"Invalid featureToken for client features"))}function Ge(){var t=Te();t!==null&&(X()==="ios"&&ue(t,"9.19")>=0||X()==="android"&&ue(t,"11.6.0")>=0)?location.href="liff://close":window._liff&&window._liff.postMessage?t!==null&&ue(t,"10.15.0")>=0?X()==="ios"?window._liff.postMessage("closeWindow",""):window._liff.postMessage("closeWindow","","",""):Qn("closeWindow"):window.close()}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"closeWindow"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return Ge()}},e})(T);function fo(t){var e=x("subWindowGetOrigin");return F(e(t))}var Oe={};function Je(t,e){t&&Oe[t]&&Oe[t].forEach(function(n){n(e)})}function ho(t,e){Oe[t]||(Oe[t]=[]),Oe[t].push(e)}function po(t,e){if(Oe[t]){var n=Oe[t].indexOf(e);n>=0&&Oe[t].splice(n,1)}}var go,mo,vo,wo,In,yo=function(){function t(e){this.storage=e}return t.prototype.getItem=function(e){return this.storage.getItem("".concat(this.getKeyPrefix(),":").concat(e))},t.prototype.setItem=function(e,n){this.storage.setItem("".concat(this.getKeyPrefix(),":").concat(e),n)},t.prototype.removeItem=function(e){this.storage.removeItem("".concat(this.getKeyPrefix(),":").concat(e))},t.prototype.clear=function(){this.storage.clear()},t.prototype.getKeyPrefix=function(){return"".concat(le,":").concat(this.getLiffId())},t.prototype.getLiffId=function(){var e=D().liffId;if(!e)throw f(ge,"liffId is necessary for liff.init()");return e},t}(),bo=new yo(new Wi);function Bt(){var t=bo.getItem("subWindowStatusUpdated");return t!==null&&JSON.parse(t)}function Fe(t){bo.setItem("subWindowStatusUpdated",String(t))}function Tn(t){go=t}function at(){return go}function Sn(){return vo}function Hr(){return wo}function _o(t){return t===void 0&&(t=ot.MAIN),p(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return[4,(In=new $u(t)).setup()];case 1:return e.sent(),[2,In]}})})}function Ze(){return In}var ju=new Wi,Io=new yo(Ki()?ju:window.sessionStorage);function Bu(t){Io.setItem("mainWindowOrigin",t)}function To(){return Io.getItem("mainWindowOrigin")}function So(t,e){return e===void 0&&(e={}),p(this,void 0,void 0,function(){var n,r,i,o,s,c,a,u;return g(this,function(l){switch(l.label){case 0:if((n=Ze())!=null&&n.isReady())return[3,5];if(r=JSON.stringify(e),i=D().liffId,o=To(),!window.opener||!o||!i)throw f(mn);s=!1,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,fo(i)];case 2:return c=l.sent(),s=c.subwindowCommonModule,[3,4];case 3:throw a=l.sent(),k.debug(a),f(mn);case 4:return u=s?o:location.origin,[2,new Promise(function(d){window.addEventListener("message",function m(h){(function(v){return!!(v.data&&typeof v.data.type=="string"&&[P.SUBMIT,P.CANCEL].includes(v.data.type))})(h)&&(window.removeEventListener("message",m),d({status:t,result:r}))}),window.opener.postMessage({status:t,result:r},u)})];case 5:return n.send({eventName:t,data:e}),[4,new Promise(function(d){setTimeout(d,500)})];case 6:return l.sent(),[2,{status:t,result:JSON.stringify(e)}]}})})}function Zn(t){var e,n=Hr();if(t.origin===n){var r=t.data;if(r){var i,o=r.status,s=r.result;try{i=JSON.parse(s||"{}")}catch{i={}}switch(o){case Ft:window.clearInterval(Sn()),er();break;case P.CANCEL:case P.SUBMIT:Fe(!0),window.clearInterval(Sn()),window.removeEventListener("message",Zn),Je(o,i),(e=at())===null||e===void 0||e.postMessage({type:o},Hr());break;default:k.debug("unexpected message")}}}}var Wu=function(t){return p(void 0,void 0,void 0,function(){var e,n,r,i;return g(this,function(o){if(Bt())return[2];switch(e=t.context,n=e.eventName,r=e.data,i=Ze(),n){case P.INIT:ko(!r.hasOpener);break;case P.CANCEL:case P.SUBMIT:Fe(!0),Je(n,r),i==null||i.reply(t,{eventName:n});break;case P.CLOSE:Bt()===!1&&(Fe(!0),Je(P.CLOSE,{})),er()}return[2]})})};function Eo(){window.clearInterval(mo),window.clearInterval(Sn()),window.removeEventListener("message",Zn)}function ko(t){if(t===void 0&&(t=!1),Eo(),Fe(!1),t){var e=at();e&&(e.close(),Tn(null))}}function er(){return p(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return(t=Ze())?[4,t.teardown()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}function Hu(t){var e;return p(this,void 0,void 0,function(){var n,r,i,o,s,c,a,u,l,d,m;return g(this,function(h){switch(h.label){case 0:return(n=Gn(t.url))?(ko(!0),[4,er()]):[2,Promise.reject(f(N,"params.url must be liff url or mini url"))];case 1:return h.sent(),Tn(X()!=="ios"||Kn()?window.open("","liffsubwindow","width=480, height=640, menubar=no, toolbar=no, scrollbars=yes"):window.open()),r=t.url,i=t.appData,(o=new URL(r)).searchParams.append(ji,"true"),[4,_o()];case 2:return s=h.sent(),o.searchParams.append(co,s.identification.identifier),o.searchParams.append(_n,s.identification.cryptoKey),o.hostname=function(y){var _=L(y.split(".")),w=_[0],b=_.slice(1);return ce(["".concat(w,"-ext")],L(b),!1).join(".")}(o.hostname),c=o.toString(),[4,fo(n)];case 3:if(a=h.sent(),u=a.origin,l=a.subwindowCommonModule,!(d=at()))throw f(gn);if(!l)return d.close(),[2];(function(y){wo=y})(u),s.listen(Wu),s.setData("appData",i),window.addEventListener("message",Zn),h.label=4;case 4:return h.trys.push([4,6,,7]),[4,(e=t.onBeforeTransition)===null||e===void 0?void 0:e.call(t)];case 5:return h.sent(),[3,7];case 6:throw m=h.sent(),d.close(),m;case 7:return d.location.href=c,v=function(y,_){var w=at(),b={type:Ft};return _&&(b.message=JSON.stringify(_)),window.setInterval(function(){w==null||w.postMessage(b,y)},Fi)}(u,i),vo=v,function(y){mo=y}(window.setInterval(function(){var y=at();y&&y.closed&&(Eo(),Tn(null),Bt()===!1&&(Fe(!0),Je(P.CLOSE,{})))},Gc)),[2]}var v})})}var tt=null;function Co(t){return p(this,void 0,void 0,function(){var e,n,r,i,o,s,c,a,u,l,d,m,h,v,y=this;return g(this,function(_){switch(_.label){case 0:if(e=t.msit,n=t.mstChallenge,r=t.reconnectCount,i=r===void 0?0:r,o=function(){return p(y,void 0,void 0,function(){return g(this,function(w){switch(w.label){case 0:return[4,(b=1e3,new Promise(function(j){return setTimeout(j,b)}))];case 1:return w.sent(),[4,Co({msit:e,mstChallenge:n,onSuccess:t.onSuccess,onError:t.onError,reconnectCount:i+1})];case 2:return w.sent(),[2]}var b})})},s=function(){for(var w=[],b=0;b<arguments.length;b++)w[b]=arguments[b];tt=null,t.onSuccess.apply(t,ce([],L(w),!1))},c=function(){for(var w=[],b=0;b<arguments.length;b++)w[b]=arguments[b];tt=null,t.onError.apply(t,ce([],L(w),!1))},a=Date.now(),tt===null&&(tt=a),u=a-tt,i>=10||u>6e5)return c(f(Z,"Failed to connect")),[2];_.label=1;case 1:return _.trys.push([1,3,,5]),[4,Au(x("subWindowSubscribe"),{method:"POST",body:JSON.stringify({msit:e,mstChallenge:n})})];case 2:return l=_.sent(),[3,5];case 3:return _.sent(),[4,o()];case 4:return _.sent(),[2];case 5:return l.status>=500?[4,o()]:[3,7];case 6:return _.sent(),[3,17];case 7:return l.status>=400&&500>l.status?[4,Vr(l)]:[3,9];case 8:return m=_.sent(),d=m?f(N,m.errorDetail):f(Z,"Some error happened in the server"),c(d),[3,17];case 9:return l.status!==200?[3,16]:[4,Vr(l)];case 10:if(!(m=_.sent()))return c(f(Z,"Some error happened in the server")),[2];switch(h=m.status,v=m.result,h){case P.ERROR:return[3,11];case P.CLOSE:case P.CANCEL:case P.SUBMIT:return[3,13]}return[3,14];case 11:return[4,o()];case 12:return _.sent(),[3,15];case 13:return s(h,v),[3,15];case 14:c(f(Z,"Some error happened in the server")),_.label=15;case 15:return[3,17];case 16:c(f(Z,"Some error happened in the server")),_.label=17;case 17:return[2]}})})}function Vr(t){return p(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t.json()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,null];case 3:return[2]}})})}function Vu(t){var e={};return Object.keys(t).forEach(function(n){n==="closeButtonColor"?t[n]==="white"?e[n]="#ffffff":e[n]="#000000":e[n]=t[n]}),e}var Gu={height:"full",closeButtonPosition:"right",closeButtonColor:"black",closeButtonLabel:""};function Ku(t){var e=t.appData,n=t.native,r=D().liffId,i=Xi(),o=Gn(t.url);if(!r)return Promise.reject(f(V,"liffId is invalid"));if(!i)return Promise.reject(f(V,"mst_challenge is invalid"));if(!o)return Promise.reject(f(N,"params.url must be liff url or mini url"));var s=Object.assign({},Gu,n);return function(c){var a=c.mainLiffId,u=c.subLiffId,l=c.mstChallenge,d=c.appData,m=c.view;return a&&l?F(x("subWindowGetMSIT"),{method:"POST",body:JSON.stringify({mainLiffId:a,subLiffId:u,mstChallenge:l,appData:d,view:m})}):Promise.reject(f(N,"no proper argument"))}({mainLiffId:r,subLiffId:o,mstChallenge:i,appData:e,view:Vu(s)}).then(function(c){var a=c.msit;return Co({msit:a,mstChallenge:i,onSuccess:function(u,l){Je(u,l)},onError:function(u){Je(P.ERROR,u)}}),a}).then(function(c){return function(a,u){var l;return p(this,void 0,void 0,function(){var d,m;return g(this,function(h){switch(h.label){case 0:return d=a.url,(m=new URLSearchParams).set("msit",u),[4,(l=a.onBeforeTransition)===null||l===void 0?void 0:l.call(a)];case 1:return h.sent(),location.href="".concat(Vc,"?url=").concat(encodeURIComponent(d),"&").concat(m.toString()),[2]}})})}(t,c)})}function Po(t){return Qe.subwindowOpen(),C()?Ku(t):Hu(t)}function tr(t){if(!t.mst||!t.status)return Promise.reject(f(N,"no proper argument"));var e=JSON.stringify(t);return F(x("subWindowPost"),{method:"POST",body:e})}function Yt(){if(!be())throw f(V,"this api can be only called in child window")}function Oo(t){return t===void 0&&(t={}),Yt(),C()?function(e){return e===void 0&&(e={}),p(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return(n=qt())?[4,tr({mst:n,status:P.CANCEL,result:e})]:[2,Promise.reject(f(V,"mst is invalid"))];case 1:return r=i.sent(),Fe(!0),[2,r]}})})}(t):function(e){return e===void 0&&(e={}),So(P.CANCEL,e)}(t)}function Ao(t){return t===void 0&&(t={}),Yt(),C()?function(e){return e===void 0&&(e={}),p(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return(n=qt())?[4,tr({mst:n,status:P.SUBMIT,result:e})]:[2,Promise.reject(f(V,"mst is invalid"))];case 1:return r=i.sent(),Fe(!0),[2,r]}})})}(t):function(e){return e===void 0&&(e={}),So(P.SUBMIT,e)}(t)}function Ro(){return Yt(),C()?function(){return p(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return Bt()!==!1?[3,2]:(t=qt())?[4,tr({mst:t,status:P.CLOSE,result:{}})]:[2,Promise.reject(f(V,"mst is invalid"))];case 1:e.sent(),e.label=2;case 2:return Ge(),[2]}})})}():function(){return p(this,void 0,void 0,function(){var t;return g(this,function(e){return(t=Ze())!=null&&t.isReady()?(t.send({eventName:P.CLOSE}),[2,new Promise(function(n){setTimeout(function(){Ge(),n()},Fi)})]):(Ge(),[2,Promise.resolve()])})})}()}function Lo(){return Yt(),function(){var t,e=iu();try{t=e?JSON.parse(e):{}}catch{t={}}return Promise.resolve(t)}()}function qu(t){var e=t.msit,n=t.mstVerifier;return e&&n?F(x("subWindowGetMSTByMSIT"),{method:"POST",body:JSON.stringify({msit:e,mstVerifier:n})}):Promise.reject(f(N,"no proper argument"))}function zu(t){var e=t.mst;return e?F(x("subWindowGetAppData"),{method:"POST",body:JSON.stringify({mst:e})}):Promise.reject(f(N,"no proper argument"))}var ne={on:ho,off:po,open:Po,cancel:Oo,submit:Ao,close:Ro,getAppData:Lo};(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"subWindow"},enumerable:!1,configurable:!0}),e.prototype.install=function(){var n=this;return{on:ho.bind(this),off:po.bind(this),open:function(r){return Po.call(n,R(R({},r),{onBeforeTransition:void 0}))},cancel:Oo.bind(this),submit:Ao.bind(this),close:Ro.bind(this),getAppData:Lo.bind(this)}},e})(T);var Ju=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var No={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.sha256=n()})(Ju,function(){var e=function n(r){function i(sr,ar){return sr>>>ar|sr<<32-ar}for(var o=Math.pow,s=o(2,32),c="length",a,u,l="",d=[],m=r[c]*8,h=n.h=n.h||[],v=n.k=n.k||[],y=v[c],_={},w=2;y<64;w++)if(!_[w]){for(a=0;a<313;a+=w)_[a]=w;h[y]=o(w,.5)*s|0,v[y++]=o(w,.3333333333333333)*s|0}for(r+="";r[c]%64-56;)r+="\0";for(a=0;a<r[c];a++){if(u=r.charCodeAt(a),u>>8)return;d[a>>2]|=u<<(3-a)%4*8}for(d[d[c]]=m/s|0,d[d[c]]=m,u=0;u<d[c];){var b=d.slice(u,u+=16),j=h;for(h=h.slice(0,8),a=0;a<64;a++){var U=b[a-15],Y=b[a-2],B=h[0],Q=h[4],bt=h[7]+(i(Q,6)^i(Q,11)^i(Q,25))+(Q&h[5]^~Q&h[6])+v[a]+(b[a]=a<16?b[a]:b[a-16]+(i(U,7)^i(U,18)^U>>>3)+b[a-7]+(i(Y,17)^i(Y,19)^Y>>>10)|0),et=(i(B,2)^i(B,13)^i(B,22))+(B&h[1]^B&h[2]^h[1]&h[2]);h=[bt+et|0].concat(h),h[4]=h[4]+bt|0}for(a=0;a<8;a++)h[a]=h[a]+j[a]|0}for(a=0;a<8;a++)for(u=3;u+1;u--){var _t=h[a]>>u*8&255;l+=(_t<16?0:"")+_t.toString(16)}return l};return e.code='var sha256=function a(b){function c(a,b){return a>>>b|a<<32-b}for(var d,e,f=Math.pow,g=f(2,32),h="length",i="",j=[],k=8*b[h],l=a.h=a.h||[],m=a.k=a.k||[],n=m[h],o={},p=2;64>n;p++)if(!o[p]){for(d=0;313>d;d+=p)o[d]=p;l[n]=f(p,.5)*g|0,m[n++]=f(p,1/3)*g|0}for(b+="\\x80";b[h]%64-56;)b+="\\x00";for(d=0;d<b[h];d++){if(e=b.charCodeAt(d),e>>8)return;j[d>>2]|=e<<(3-d)%4*8}for(j[j[h]]=k/g|0,j[j[h]]=k,e=0;e<j[h];){var q=j.slice(e,e+=16),r=l;for(l=l.slice(0,8),d=0;64>d;d++){var s=q[d-15],t=q[d-2],u=l[0],v=l[4],w=l[7]+(c(v,6)^c(v,11)^c(v,25))+(v&l[5]^~v&l[6])+m[d]+(q[d]=16>d?q[d]:q[d-16]+(c(s,7)^c(s,18)^s>>>3)+q[d-7]+(c(t,17)^c(t,19)^t>>>10)|0),x=(c(u,2)^c(u,13)^c(u,22))+(u&l[1]^u&l[2]^l[1]&l[2]);l=[w+x|0].concat(l),l[4]=l[4]+w|0}for(d=0;8>d;d++)l[d]=l[d]+r[d]|0}for(d=0;8>d;d++)for(e=3;e+1;e--){var y=l[d]>>8*e&255;i+=(16>y?0:"")+y.toString(16)}return i};',e})})(No);var Yu=No.exports;const Qu=Xu(Yu);var Zu=function(){var t=this;this.type="sync",this.fns=new Set,this.on=function(e){t.fns.add(e)},this.call=function(){for(var e,n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{for(var o=Wt(t.fns),s=o.next();!s.done;s=o.next()){var c=s.value;c.apply(void 0,ce([],L(r),!1))}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}}},nt=function(){var t=this;this.type="async",this.fns=new Set,this.on=function(e){t.fns.add(e)},this.call=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return p(t,void 0,void 0,function(){var r,i,o,s,c,a;return g(this,function(u){switch(u.label){case 0:r=[];try{for(i=Wt(this.fns),o=i.next();!o.done;o=i.next())s=o.value,r.push(s.apply(void 0,ce([],L(e),!1)))}catch(l){c={error:l}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(c)throw c.error}}return[4,Promise.all(r)];case 1:return u.sent(),[2]}})})}},ct=function(t){var e,n=ze(43),r=zc(Qu(n)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),i=D();if(!i||!i.liffId)throw f(ge,"You need to define `liffId` for liff.login()");var o={app_id:i.liffId,state:ze(12),response_type:"code",code_challenge_method:"S256",code_challenge:r,liff_sdk_version:Xt()};t&&t.redirectUri&&(o.redirect_uri=t.redirectUri),be()&&!C()&&(!((e=Ze())===null||e===void 0)&&e.isReady()?o.redirect_uri=window.location.href:o.disable_auto_login="true"),hu({codeVerifier:n});var s=x("authorize")+"?"+q.stringify(o);k.debug("[Redirect] ".concat(s)),window.location.href=s},el=function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.hooks={before:new Zu},n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"login"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return this._login.bind(this)},e.prototype._login=function(n){this.hooks.before.call(n),ct(n)},e}(T),cn,Rt=typeof navigator>"u"?"en":(cn=navigator.language)!==null&&cn!==void 0?cn:"en",En=null;function tl(t){return p(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return Rt=t,[4,Uo()];case 1:return e.sent(),[2]}})})}function Uo(){return p(this,void 0,void 0,function(){var t,e;return g(this,function(n){switch(n.label){case 0:return[4,F("".concat("https://liffsdk.line-scdn.net/xlt/manifest.json"),{method:"GET",headers:{Accept:"application/json"}})];case 1:return t=n.sent(),e="".concat(Rt),!t.languages[e]&&Rt.includes("-")&&(e=Rt.split("-")[0]),t.languages[e]||(e="en"),[4,F("".concat("https://liffsdk.line-scdn.net/xlt","/").concat(t.languages[e]),{method:"GET",headers:{Accept:"application/json"}})];case 2:return En=n.sent(),[2]}})})}function un(t){if(En===null)throw f(M,"please call xlt after liff.init");return En[t]}var nl=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"i18n"},enumerable:!1,configurable:!0}),e.prototype.install=function(n){return n.internalHooks.init.beforeFinished(this.beforeInitFinished.bind(this)),{setLang:tl}},e.prototype.beforeInitFinished=function(){return p(this,void 0,void 0,function(){return g(this,function(n){switch(n.label){case 0:return[4,Uo()];case 1:return n.sent(),[2]}})})},e}(T),rl=new nl,Gr={iconColor:"#111111",statusBarColor:"BLACK",titleTextColor:"#111111",titleSubtextColor:"#B7B7B7",titleButtonColor:"#111111",titleBackgroundColor:"#FFFFFF",progressBarColor:"#06C755",progressBackgroundColor:"#FFFFFF",titleButtonAreaBackgroundColor:"#1FFFFFFF",titleButtonAreaBorderColor:"#26000000",baseBackgroundColor:"#FFFFFF",baseTextColor:"#000000",lightButtonBorderColor:"rgba(0, 0, 0, 0.15)"},Kr={iconColor:"#FFFFFF",statusBarColor:"WHITE",titleTextColor:"#FFFFFF",titleSubtextColor:"#949494",titleButtonColor:"#FFFFFF",titleBackgroundColor:"#111111",progressBarColor:"#06C755",progressBackgroundColor:"#111111",titleButtonAreaBackgroundColor:"#1FFFFFFF",titleButtonAreaBorderColor:"#26000000",baseBackgroundColor:"#000000",baseTextColor:"#FFFFFF",lightButtonBorderColor:"rgba(255, 255, 255, 0.5)"};function il(){var t;K("color-scheme",(((t=G())==null?void 0:t.menuColorSetting)||{adaptableColorSchemes:["light"]}).adaptableColorSchemes.join(" "));var e=window.matchMedia("(prefers-color-scheme: dark)");ln({matches:e==null?void 0:e.matches,media:e==null?void 0:e.media}),e.addEventListener?e.addEventListener("change",ln):e.addListener&&e.addListener(ln)}function ln(t){var e=G(),n=(e==null?void 0:e.menuColorSetting)||{adaptableColorSchemes:["light"],lightModeColor:Gr,darkModeColor:Kr},r=n.adaptableColorSchemes,i=n.lightModeColor,o=n.darkModeColor,s=r.includes("dark");t.matches&&s?qr(R(R({},Kr),o)):qr(R(R({},Gr),i))}function qr(t){var e=t.iconColor,n=t.statusBarColor,r=t.titleTextColor,i=t.titleSubtextColor,o=t.titleButtonColor,s=t.titleBackgroundColor,c=t.progressBarColor,a=t.progressBackgroundColor,u=t.titleButtonAreaBackgroundColor,l=t.titleButtonAreaBorderColor,d=t.baseBackgroundColor,m=t.baseTextColor,h=t.lightButtonBorderColor;K("--liff-base-background-color",d),K("--liff-base-text-color",m),K("--liff-base-background-rgb-color",Nr(d)),K("--liff-base-text-rgb-color",Nr(m)),K("--liff-light-button-border-color",h),K("--liff-title-text-color",r),K("--liff-title-background-color",s),K("--liff-title-button-color",o),K("--liff-icon-color",e),K("--liff-status-bar-color",n),K("--liff-title-subtext-color",i),K("--liff-progress-bar-color",c),K("--liff-progress-background-color",a),K("--liff-title-button-area-background-color",Lr(u)),K("--liff-title-button-area-border-color",Lr(l))}function K(t,e){document.documentElement.style.setProperty(t,e)}var ol={addToHomeScreen:function(t){if(!new an(t).invoke("addToHomeScreen"))throw f(O,"No permission for liff.addToHomeScreen()")},scanCode:function(t){if(!new an(t).invoke("scanCode"))return Promise.reject(f(O,"No permission for liff.scanCode()"))},getAdvertisingId:function(t){if(!new an(t).invoke("getAdvertisingId"))return Promise.reject(f(O,"No permission for liff.getAdvertisingId()"))},initPlugins:function(){}};function sl(t){return p(this,void 0,void 0,function(){var e;return g(this,function(n){switch(n.label){case 0:return[4,Pu()];case 1:return(e=n.sent())?(e.install(t,ol),[2]):[2]}})})}function al(){return p(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return[4,F(x("certs"))];case 1:return[2,t.sent()]}})})}function cl(t,e,n){return p(this,void 0,void 0,function(){var r;return g(this,function(i){switch(i.label){case 0:return[4,crypto.subtle.importKey("jwk",t,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"])];case 1:return r=i.sent(),[4,crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},r,n,e)];case 2:return[2,i.sent()]}})})}function xo(t,e){return p(this,void 0,void 0,function(){var n,r,i,o,s,c,a,u,l,d,m,h,v,y,_,w;return g(this,function(b){switch(b.label){case 0:return n=t.split("."),r=L(n,3),i=r[0],o=r[1],s=r[2],c=JSON.parse(rn.decode(i)),a=JSON.parse(rn.decodeUnicode(o)),u=Ur(rn.decode(s)),l=Ur("".concat(i,".").concat(o)),[4,al()];case 1:if(d=b.sent(),!(m=d.keys.find(function(j){return j.kid===c.kid})))return[3,6];if(delete m.alg,c.alg!=="ES256")throw f(Ae,'Invalid "alg" value in ID_TOKEN');h=void 0,b.label=2;case 2:return b.trys.push([2,4,,5]),[4,cl(m,l,u)];case 3:return h=b.sent(),[3,5];case 4:throw v=b.sent(),f(Ae,"".concat("Failed to use Crypto API to verify ID_TOKEN",": ").concat(v));case 5:if(h){if(y=a.iss!=="https://access.".concat("line.me"),_=a.aud!==e,w=1e3*a.exp<Date.now(),y)throw f(Ae,'Invalid "iss" value in ID_TOKEN');if(_)throw f(Ae,'Invalid "aud" value in ID_TOKEN');if(w)throw f(Ae,'Invalid "exp" value in ID_TOKEN');return[2,a]}throw f(Ae,"Invalid signature in ID_TOKEN");case 6:throw f(Ae,'Invalid "kid" value in ID_TOKEN');case 7:return[2]}})})}function nr(t){var e=t.split(".");if(e[1])try{var n=e[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(window.atob(n))}catch{return null}return null}function Do(t){var e=t.pathname,n=t.query,r=n?"?".concat(q.stringify(n)):"",i="".concat("liff://").concat(e).concat(r);location.href=i}var kn=null;function ul(){typeof kn=="boolean"&&k.warn("liff.init is not expected to be called more than once"),kn=!!nu()||!(!C()||q.parse(window.location.hash).feature_token||wt())&&(ru(!0),!0)}function Cn(){return!!kn}function ll(t,e){return p(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return(n=qt())?[2,n]:t&&e?[4,qu({msit:t,mstVerifier:e})]:[3,2];case 1:return[2,r.sent().mst];case 2:return[2,null]}})})}function dl(t){return F("".concat(x("apps"),"/").concat(t,"/featureToken"))}function fl(t){return p(this,void 0,void 0,function(){var e,n,r,i;return g(this,function(o){switch(o.label){case 0:return e=q.parse(window.location.hash),n=function(s){for(var c,a,u=[],l=1;l<arguments.length;l++)u[l-1]=arguments[l];var d=function(v){Object.keys(v).filter(function(y){return v[y]!==null&&v[y]!==void 0}).forEach(function(y){s[y]=v[y]})};try{for(var m=Wt(u),h=m.next();!h.done;h=m.next())d(h.value)}catch(v){c={error:v}}finally{try{h&&!h.done&&(a=m.return)&&a.call(m)}finally{if(c)throw c.error}}return s}({access_token:Ie(),context_token:fu(),feature_token:wt(),id_token:zt(),client_id:du(),mst_challenge:Xi(),mst_verifier:ou(),msit:au()},e),Cn()?z()?[4,dl(t)]:[3,2]:[3,3];case 1:r=o.sent().featureToken,n.feature_token||(n.feature_token=r),o.label=2;case 2:(i=Vn(t))&&(n.client_id=i),o.label=3;case 3:return[2,n]}})})}function hl(t){if(t.persisted&&yt("multipleLiffTransition"))if(X()==="ios")window.location.reload();else{var e=D().liffId,n=wt();if(!e)throw f(M,"Invalid LIFF ID.");if(!n)throw f(O,"Invalid featureToken for client features");Do({pathname:"app/".concat(e),query:{feature_token:n}})}}function pl(t){var e,n;return p(this,void 0,void 0,function(){var r,i,o,s,c,a,u,l,d,m,h,v,y,_,w,b,j;return g(this,function(U){switch(U.label){case 0:return[4,new Promise(function(Y){var B=Te();if(!B||ue(B,"9.5.0")<0)Y();else if(window._liff&&window._liff.features)Y();else{k.debug("cannot find window._liff.features, listen to ready event");var Q=function(){k.debug("ready event is fired"),Yn("ready",Q),Y()};Xn("ready",Q)}})];case 1:return U.sent(),ul(),[4,fl(t.liffId)];case 2:if(r=U.sent(),i=r.access_token,o=r.context_token,s=r.feature_token,c=r.id_token,a=r.client_id,u=r.mst_verifier,l=r.mst_challenge,d=r.msit,o){if(typeof o!="string")throw f(M,"Cannot get context token, perhaps there is an incorrect parameter in permanent link");qn(nr(o))}if(((e=G())===null||e===void 0?void 0:e.liffId)!==void 0&&((n=G())===null||n===void 0?void 0:n.liffId)!==t.liffId)throw f(M,"Invalid LIFF ID");return!be()&&s&&(function(Y,B){yt("multipleLiffTransition")&&Do({pathname:"app/".concat(Y),query:{feature_token:B}})}(t.liffId,s),Cn()&&Fr(s)),l&&lu(l),u&&su(u),a&&Yi(a),d&&cu(d),window.addEventListener("pageshow",hl),z()?[3,5]:s&&i?[3,5]:Cn()?(m=ft(location.href,{"liff.hback":"2"}),ct({redirectUri:m}),[4,new Promise(function(){})]):[3,4];case 3:U.sent(),U.label=4;case 4:throw ct(),f(M,"Failed to parse feature_token or access_token");case 5:return i&&s?[4,ao(i)]:[3,7];case 6:if(h=U.sent(),v=h.client_id,y=h.expires_in,_=Vn(t.liffId),v!==_)throw ct(),f(M,"Failed to verify access_token");Fr(s),to(new Date(Date.now()+1e3*y)),zn(i),U.label=7;case 7:return[4,ll(d,u)];case 8:return(w=U.sent())?(uu(w),[4,zu({mst:w})]):[3,10];case 9:(b=U.sent().data)&&yn(JSON.stringify(b)),U.label=10;case 10:return c&&!zt()&&Qi(c),c&&a&&!Jt()?[4,xo(c,a)]:[3,12];case 11:(j=U.sent())&&no(j),U.label=12;case 12:return[2]}})})}function gl(t){return p(this,void 0,void 0,function(){var e,n,r,i,o,s,c;return g(this,function(a){switch(a.label){case 0:return e=x("apps"),n="".concat(e,"/").concat(t,"/contextToken"),r=Ie(),i={"Content-Type":"application/json",Accept:"application/json"},r&&(i.Authorization="Bearer ".concat(r)),[4,F(n,{headers:i})];case 1:if(o=a.sent(),!(s=o.contextToken))throw f(M,"Can not get context from server.");if(!(c=nr(s)))throw f(M,"Invalid context token.");return[2,c]}})})}function $o(){return p(this,void 0,void 0,function(){var t,e;return g(this,function(n){switch(n.label){case 0:if(!(t=D().liffId))throw f(M,"Invalid LIFF ID.");return[4,gl(t)];case 1:return e=n.sent(),qn(e),[2]}})})}function ml(t){return p(this,void 0,void 0,function(){var e,n,r,i=this;return g(this,function(o){switch(o.label){case 0:e=function(){return p(i,void 0,void 0,function(){var s,c,a,u,l,d;return g(this,function(m){switch(m.label){case 0:return[4,(h=D(),v=q.parse(window.location.search),y=eo(),_={grant_type:"authorization_code",client_id:v.liffClientId,appId:h.liffId,code:v.code,code_verifier:y.codeVerifier,redirect_uri:h.redirectUri||v.liffRedirectUri,id_token_key_type:"JWK"},w=q.stringify(_),F(x("token"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},body:w}))];case 1:return s=m.sent(),c=s.access_token,a=s.id_token,u=s.expires_in,Yi(t),zn(c),to(new Date(Date.now()+1e3*u)),jr(),a?(Qi(a),[4,xo(a,t)]):[3,3];case 2:(l=m.sent())&&no(l),m.label=3;case 3:return(d=q.parse(location.hash).context_token)?(qn(nr(d)),[3,6]):[3,4];case 4:return[4,$o()];case 5:m.sent(),m.label=6;case 6:return[2]}var h,v,y,_,w})})},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e()];case 2:return o.sent(),[3,4];case 3:throw n=o.sent(),r=n,jr(),r;case 4:return[2]}})})}function Mo(){return p(this,void 0,void 0,function(){var t,e,n,r,i,o,s=this;return g(this,function(c){switch(c.label){case 0:return(e=Ze())?[3,2]:[4,_o(ot.SUB)];case 1:e=c.sent(),c.label=2;case 2:return(t=e).isReady()?(n=ze(8),[4,t.getData("appData")]):[3,8];case 3:return r=c.sent(),i=r.eventName,o=r.data,i!==At.NOT_FOUND?[3,6]:[4,t.teardown()];case 4:return c.sent(),[4,Mo()];case 5:return[2,c.sent()];case 6:o&&yn(JSON.stringify(o)),c.label=7;case 7:return t.listen(function(a){return p(s,void 0,void 0,function(){var u,l;return g(this,function(d){return u=a.context,l=u.data,u.eventName===P.INIT&&(l==null?void 0:l.subWindowId)!==n&&Ge(),u.eventName!==P.CANCEL&&u.eventName!==P.SUBMIT||t.teardown(),[2]})})}),z()&&t.send({eventName:P.INIT,data:{subWindowId:n,hasOpener:!!window.opener}}),[3,10];case 8:return To()?[3,10]:[4,new Promise(function(a){window.addEventListener("message",function(u){return function l(d){var m=d.data,h=d.source,v=d.origin;if(m){var y=m.type,_=m.message;y===Ft&&(window.removeEventListener("message",l),_&&yn(_),Bu(v),h&&h.postMessage&&h.postMessage({status:Ft},v),u())}}}(a))})];case 9:return[2,c.sent()];case 10:return[2]}})})}var vl=new(function(){function t(){var e=this;this.getAndValidateContext=function(){var n=G();if(!n)throw f(M,"Could not get Context from server.");if(!n.endpointUrl)throw f(M,"Could not get endpointUrl from server.");if(!n.permanentLinkPattern)throw f(M,"Could not get permanentLinkPattern from server.");return n},this.decodeState=function(n){var r=e.getAndValidateContext();n=n.replace(/\n/g,"%0D%0A");var i=!r.endpointUrl.startsWith("/?")&&r.endpointUrl.includes("/?")||!r.endpointUrl.startsWith("/#")&&r.endpointUrl.includes("/#")||r.endpointUrl.endsWith("/")||!n.startsWith("/?")&&n.includes("/?")||!n.startsWith("/#")&&n.includes("/#")||n.endsWith("/"),o=new URL(r.endpointUrl),s=o.origin,c=o.pathname,a=o.search,u=new URL("".concat(s).concat(e.attachSlashAtStart(n))),l=u.pathname,d=u.search,m=u.hash,h="".concat(a).concat(a?d.replace(/\?/g,"&"):d),v="".concat(c).concat(e.attachSlashAtStart(l)).replace("//","/");return(v=e.attachSlashAtStart("".concat(v))).endsWith("/")&&!i&&(v=v.substring(0,v.length-1)),"".concat(s).concat(v).concat(h).concat(m).replace(/%0D%0A/g,`
`)}}return t.prototype.attachSlashAtStart=function(e){return"".concat(e&&e.length>0&&!e.startsWith("/")?"/":"").concat(e)},t.prototype.invoke=function(){return p(this,void 0,void 0,function(){var e,n,r,i,o;return g(this,function(s){switch(s.label){case 0:if(e=q.parse(window.location.search),typeof(n=e["liff.state"])!="string")return[2];s.label=1;case 1:return s.trys.push([1,4,,5]),r=location.href,(i=this.decodeState(n))===r?[3,3]:(e["liff.hback"]?location.replace(ft(i,{"liff.hback":e["liff.hback"]})):location.replace(i),[4,new Promise(function(){})]);case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if((o=s.sent()).code===M)throw o;return k.debug(o),[3,5];case 5:return[2]}})})},t}());function wl(t,e){return p(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:if(!t.liffId)throw f(ge,"liffId is necessary for liff.init()");return eu(t),!C()&&z()&&(pu()||Jn()),n=q.parse(window.location.search),!be()||C()?[3,2]:[4,Mo()];case 1:r.sent(),r.label=2;case 2:if(n.error&&n.liffOAuth2Error)throw s=n.error,c=n.error_description,a=c.replace(/\+/g," "),u="".concat(s,": ").concat(a),f(M,u);return i=n.code,o=eo(),i&&!z()&&o&&o.codeVerifier?[4,ml(n.liffClientId)]:[3,4];case 3:r.sent(),r.label=4;case 4:return C()?[4,pl(t)]:[3,6];case 5:return r.sent(),[3,8];case 6:return z()?[3,8]:[4,$o()];case 7:r.sent(),r.label=8;case 8:return[4,vl.invoke()];case 9:return r.sent(),[4,e()];case 10:return r.sent(),Yc(window.location.href),[2]}var i,o,s,c,a,u})})}var Fo=function(t,e){return new Promise(function(n,r){if(t){var i=document.createElement("script");i.type="module",i.onload=function(){n()},i.src=t,document.head.appendChild(i)}else r(f(ge,e))})},yl=function(t){var e="https://static.line-scdn.net/lui/edge/versions/1.13.0/lui-alert.js";return e&&t&&(e=e.replace(/\d{1,2}\.\d{1,2}\.\d{1,3}/,t)),Fo(e,"LUI_ALERT_URL is not defined")},dn=function(){return p(void 0,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return t=function(){var r,i=document.querySelector('script[src*="luivendor.js"]');if(i&&(!((r=i.src.match(/\d{1,2}\.\d{1,2}\.\d{1,3}/g))===null||r===void 0)&&r.length))return i.src.match(/\d{1,2}\.\d{1,2}\.\d{1,3}/g)[0]}(),t?[3,2]:[4,Fo("https://static.line-scdn.net/lui/edge/versions/1.13.0/luivendor.js","LUI_VENDOR_URL is not defined")];case 1:e.sent(),e.label=2;case 2:return[4,yl(t)];case 3:return e.sent(),[4,(n=ze(6),new Promise(function(){var r=document.createElement("div");r.innerHTML='<lui-alert id="'.concat("liffAlert","-").concat(n,'" shown title="').concat(un("alert.android.extBrowser.autoLoginWorkaround.title"),'" message="').concat(un("alert.android.extBrowser.autoLoginWorkaround.desc"),'" button="').concat(un("alert.android.extBrowser.autoLoginWorkaround.button.text"),'"></lui-alert>'),document.body.appendChild(r);var i=document.getElementById("".concat("liffAlert","-").concat(n));i&&i.addEventListener("lui-button-click",function(){var o=window.open(ft(window.location.href,{liffIsEscapedFromApp:"true"}),"_blank");o&&(o.location.href=ft(window.location.href,{liffIsEscapedFromApp:"true"}),window.close())})}))];case 4:return e.sent(),[2]}var n})})},zr=function(t){try{return new URL(t).searchParams.get("lineAppVersion")}catch{return null}};function bl(){var t;return p(this,void 0,void 0,function(){var e,n;return g(this,function(r){switch(r.label){case 0:return e=(t=zr(window.location.href))!==null&&t!==void 0?t:zr(window.document.referrer),e&&ue(e,"13.10.0")>=0?[2]:C()||X()!=="android"||(n=q.parse(window.location.search))[co]||n.liffIsEscapedFromApp?[2]:n.liffClientId&&document.referrer.includes("access.".concat("line.me"))?(window.location.href=ft(window.location.href,{liffIsEscapedFromApp:"true"}),[2]):n.liffClientId&&document.referrer.includes("android-app://")?[4,dn()]:[3,2];case 1:r.sent(),r.label=2;case 2:return n.liffClientId&&document.referrer===""&&window.history.length===1?[4,dn()]:[3,4];case 3:r.sent(),r.label=4;case 4:return!document.referrer.includes("liffClientId")||document.referrer.includes("liffIsEscapedFromApp")?[3,6]:[4,dn()];case 5:r.sent(),r.label=6;case 6:return[2]}})})}var _l=function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.hooks={before:new nt,after:new nt},n.internalHooks={beforeFinished:new nt,beforeSuccess:new nt,error:new nt},n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"init"},enumerable:!1,configurable:!0}),e.prototype.install=function(n){var r=n.liff;return this.liffForWindow=r,this.init.bind(this)},e.prototype.init=function(n,r,i){return p(this,void 0,void 0,function(){var o;return g(this,function(s){switch(s.label){case 0:return[4,this.hooks.before.call()];case 1:s.sent(),c=this.liffForWindow,window&&!window.liff&&(window.liff=c),s.label=2;case 2:return s.trys.push([2,9,,11]),[4,Promise.all([sl(this.liffForWindow),wl(n,this.internalHooks.beforeFinished.call)])];case 3:return s.sent(),il(),[4,this.internalHooks.beforeSuccess.call()];case 4:return s.sent(),!n.withLoginOnExternalBrowser||z()?[3,6]:(ct(),[4,new Promise(function(){})]);case 5:s.sent(),s.label=6;case 6:return[4,bl()];case 7:return s.sent(),[4,this.hooks.after.call()];case 8:return s.sent(),typeof r=="function"&&r(),$i(),[3,11];case 9:return o=s.sent(),[4,this.internalHooks.error.call(o)];case 10:throw s.sent(),typeof i=="function"&&i(o),o;case 11:return[2]}var c})})},e}(T);function jo(){return navigator.language}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getLanguage"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(){return jo()}},e})(T);function Bo(t){return p(this,void 0,void 0,function(){var e,n,r,i,o,s,c;return g(this,function(a){switch(a.label){case 0:return function(u){if(!Kc.includes(u))throw f(N,"Unexpected permission name.");var l=G();return!!(l!=null&&l.scope.includes(u))}(t)?(e=Ie())?[4,ao(e)]:[3,2]:[2,{state:"unavailable"}];case 1:n=a.sent(),r=unescape(n.scope).split(" ");try{for(i=Wt(r),o=i.next();!o.done;o=i.next())if(o.value.includes(t))return[2,{state:"granted"}]}catch(u){s={error:u}}finally{try{o&&!o.done&&(c=i.return)&&c.call(i)}finally{if(s)throw s.error}}return[2,{state:"prompt"}];case 2:throw f(V,"LiffId is not found.")}})})}function Wo(){var t,e,n=G();return!!n&&n.type!=="square_chat"&&(yt("skipChannelVerificationScreen")||!C()&&((e=(t=n.availability)===null||t===void 0?void 0:t.skipChannelVerificationScreen)===null||e===void 0?void 0:e.permission))}function Il(){var t=D().liffId;if(t)return F("".concat(x("unauthorizedPermissions"),"?liffId=").concat(t),{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(Ie())}});throw f(V,"liffId is required")}var Lt,St=ne.on,Et=ne.off,Tl=ne.open,Sl=function(){function t(e,n){var r=this;this.onSubmit=function(i){var o=i.newAccessToken,s=i.ICA_ERROR;return p(r,void 0,void 0,function(){return g(this,function(c){return o?this.resolve({newAccessToken:o}):s&&this.reject(f(Z,s)),this.teardown(),[2]})})},this.onClose=function(){return p(r,void 0,void 0,function(){return g(this,function(i){return this.reject(f(V,"user didn't allow the agreement")),this.teardown(),[2]})})},this.onCancel=function(){return p(r,void 0,void 0,function(){return g(this,function(i){return this.reject(f(V,"user didn't allow the agreement")),this.teardown(),[2]})})},this.onError=function(i){return p(r,void 0,void 0,function(){return g(this,function(o){return this.reject(i),this.teardown(),[2]})})},this.resolve=e,this.reject=n,this.setup()}return t.prototype.setup=function(){St("submit",this.onSubmit),St("close",this.onClose),St("cancel",this.onCancel),St("error",this.onError)},t.prototype.teardown=function(){Et("submit",this.onSubmit),Et("close",this.onClose),Et("cancel",this.onCancel),Et("error",this.onError),Lt=void 0},t.prototype.open=function(e){var n=D().liffId;n?Tl({url:"".concat("https://liff.line.me/1656032314-Xgrw5Pmk"),appData:{liffId:n,channelId:Vn(n),accessToken:Ie()},onBeforeTransition:e}).catch(this.reject):this.reject(f(V,"liffId is required"))},t}();function Ho(){return p(this,void 0,void 0,function(){var t,e,n=this;return g(this,function(r){switch(r.label){case 0:if(!Wo())throw f(O,"SkipChannelVerificationScreen is unavailable.");return Lt&&Lt.teardown(),t=function(){return p(n,void 0,void 0,function(){var i;return g(this,function(o){switch(o.label){case 0:return[4,Il()];case 1:if(i=o.sent(),(C()?i:i.filter(function(s){return s!=="chat_message.write"})).length<=0)throw f(O,"All permissions have already been approved.");return[2]}})})},[4,new Promise(function(i,o){(Lt=new Sl(i,o)).open(t)})];case 1:return e=r.sent().newAccessToken,zn(e),[2]}})})}function Ke(t,e){var n=this;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return p(n,void 0,void 0,function(){var o,s,c;return g(this,function(a){switch(a.label){case 0:return o=(r.length>0?r[r.length-1]:{}).ignorePermissionCheck,s=o!==void 0&&o,[4,Bo(e)];case 1:if((c=a.sent().state)!=="unavailable")return[3,2];throw f(O,"The permission is not in LIFF app scope.");case 2:return c!=="prompt"||!Wo()||s||!C()&&e==="chat_message.write"?[3,4]:[4,Ho()];case 3:return a.sent(),[3,5];case 4:s&&r.pop(),a.label=5;case 5:return[4,t.apply(void 0,ce([],L(r),!1))];case 6:return[2,a.sent()]}})})}}var El=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"permission"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return{query:Bo,requestAll:Ho}},e}(T),kl=new El;function rr(){return F(x("profile"))}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getProfile"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return Ke(rr,"profile")},e})(T);var Cl=function(t,e){return t?"&".concat(t.split("&").filter(function(n){return n.indexOf("is_liff_external_open_window")===-1}).join("&").concat("".concat(e?"#".concat(e):""))):"".concat(e?"#".concat(e):"")};function Qt(t){if(!function(o){if(!o||typeof o!="object")return!1;var s=o,c=s.url,a=s.external,u=L([typeof c,typeof a],2),l=u[0],d=u[1];return l==="string"&&c!==""&&(d==="undefined"||d==="boolean")}(t))throw f(N,"Invalid parameters for liff.openWindow()");var e=Te();if(C())if(e!==null&&X()==="ios"&&ue(e,"9.19")>=0||!window._liff.postMessage){var n=t.url,r=t.external,i=r!==void 0&&r;window.open(function(o,s){var c,a,u,l,d,m,h,v,y;(function(w){return w.indexOf("#")!==-1&&w.indexOf("?")!==-1&&w.indexOf("#")<w.indexOf("?")})(o)||function(w){return w.indexOf("?")===-1&&w.indexOf("#")!==-1}(o)?(h=(c=L(o.split("#"),2))[0],a=c[1],v=(u=L((a===void 0?"":a).split("?"),2))[0],y=u[1]):(h=(l=L(o.split("?"),2))[0],d=l[1],y=(m=L((d===void 0?"":d).split("#"),2))[0],v=m[1]);var _=Cl(y,v);return"".concat(h,"?").concat("is_liff_external_open_window","=").concat(!!s).concat(_)}(n,i))}else Qn("openWindow",t);else window.open(t.url,"_blank")}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"openWindow"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(n){return Qt(n)}},e})(T);var Pl=function(t){return typeof t=="object"&&t!==null&&function(e){return typeof e=="string"||e instanceof String}(t.type)};function Jr(t){return Promise.reject(f(N,t))}function Vo(t){if(!function(n){return Array.isArray(n)&&n.every(Pl)}(t))return Jr("Parameter 'messages' must be an array of { type, ... }");var e=t.length;return e<1||e>5?Jr("Number of messages should be in range 1 to ".concat(5,".")):F(x("message"),{method:"POST",body:JSON.stringify({messages:t})}).catch(Ol)}var Ol=function(t){if(t.code==="403"){var e=Te()==="12.0.0",n=X()==="ios",r=Kn();e&&(n||r)&&window.alert(`LINEアプリをLINE 12.0.1以降にアップデートしてください。
Please update your LINE app to LINE 12.0.1 or later.`)}throw t};(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"sendMessages"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return Ke(Vo,"chat_message.write")},e})(T);function Go(){return F(x("friendship"))}(function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"getFriendship"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return Ke(Go,"profile")},e})(T);function Al(){return p(this,void 0,void 0,function(){var t,e;return g(this,function(n){switch(n.label){case 0:if(!z())return[3,6];n.label=1;case 1:return n.trys.push([1,5,,6]),(t=Jt())&&t.sub?[2,t.sub]:[3,2];case 2:return[4,rr()];case 3:if((e=n.sent())&&e.userId)return[2,e.userId];n.label=4;case 4:return[3,6];case 5:return n.sent(),k.debug("can't retrieve Mid/Uid because of something wrong"),[3,6];case 6:return[2]}})})}function Rl(){return p(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,Al()];case 1:return(t=e.sent())&&t.substring(0,1)==="u"?[2,t]:[2]}})})}var Ll=function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.utsExtra={isLiffSuccessful:!1,isLoggedIn:!1,id:"",version:""},n.injected=!1,n}return S(e,t),Object.defineProperty(e,"CUSTOMPLACEID_INIT",{get:function(){return"liff.init"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CUSTOMTYPE",{get:function(){return"liffSdk"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LiffUtsLoginStatus",{get:function(){return{isLoggedIn:1,isLiffSuccessful:2}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return"analytics"},enumerable:!1,configurable:!0}),e.prototype.install=function(n){var r=n.liff,i=n.internalHooks;this.liffCore=r,i.init.beforeFinished(this.beforeInitFinished.bind(this)),i.init.beforeSuccess(this.beforeInitSuccess.bind(this)),i.init.error(this.initError.bind(this))},e.prototype.changeRatioToUTSFormat=function(n){if(n&&Number.isFinite(n))return Math.round(100*n)},e.prototype.setExtra=function(){var n,r=this.utsExtra,i=r.isLiffSuccessful,o=r.isLoggedIn,s=r.id,c=r.version,a=(o?e.LiffUtsLoginStatus.isLoggedIn:0)|(i?e.LiffUtsLoginStatus.isLiffSuccessful:0);(n=this.uts)===null||n===void 0||n.setExtra("liff",{id:s,loginStatus:a,version:c})},e.prototype.assignUtsExtra=function(n){Object.assign(this.utsExtra,n)},e.prototype.setVersion=function(n){this.assignUtsExtra({version:n}),k.debug("[LIFFUTS][SDK version] ".concat(n)),this.setExtra()},e.prototype.setLiffId=function(n){this.assignUtsExtra({id:n}),k.debug("[LIFFUTS][LIFFID] ".concat(n)),this.setExtra()},e.prototype.setIsLoggedIn=function(n){this.assignUtsExtra({isLoggedIn:n}),k.debug("[LIFFUTS][isLoggedIn] ".concat(n)),this.setExtra()},e.prototype.sendLiffInit=function(){var n;k.debug("[LIFFUTS][sendCustom] liff.init"),(n=this.uts)===null||n===void 0||n.sendCustom({type:e.CUSTOMTYPE,params:{placeId:e.CUSTOMPLACEID_INIT}})},e.prototype.setIsLiffSuccessful=function(n){this.assignUtsExtra({isLiffSuccessful:n}),k.debug("[LIFFUTS][isLiffInitSuccessful] ".concat(n)),this.setExtra()},e.prototype.prepareReferrer=function(n){var r={};Object.keys(n).forEach(function(i){if(Hc.includes(i)){var o=n[i];typeof o=="string"&&o&&(r[i.replace(/^liff\.ref\./,"")]=o)}}),Object.keys(r).length>0&&(this.referrer=r)},e.prototype.beforeInitFinished=function(){return p(this,void 0,void 0,function(){var n,r,i,o,s,c,a,u,l,d,m,h;return g(this,function(v){switch(v.label){case 0:if(n=q.parse(window.location.search),this.prepareReferrer(n),r=G(),!(i=r==null?void 0:r.utsTracking))return[2];if(o=D(),s=o.liffId,c=o.analytics,i.mode!=="auto"||!c)return[3,6];k.debug("[LIFFUTS] ".concat(new Date().toUTCString())),v.label=1;case 1:return v.trys.push([1,3,,4]),a=this,[4,new Promise(function(y,_){var w=window.uts,b=document.createElement("script");b.type="text/javascript",b.src="https://static.line-scdn.net/uts/edge/4.1.0/uts.js",b.onload=function(){var j=window.uts;y(j),window.uts=w},b.onerror=function(j){_(j)},document.getElementsByTagName("head")[0].appendChild(b)})];case 2:return a.uts=v.sent(),[3,4];case 3:return u=v.sent(),k.debug("[LIFFUTS] cannot load UTS, reason: ".concat(u)),[2];case 4:return l=R(R({},c.context),{utsId:c.context.utsId,appName:c.context.appName,appEnv:c.context.appEnv||"release"}),d=R(R({endpoint:"https://uts-front.line-apps.com"},c.options),{sampleRate:this.changeRatioToUTSFormat(i.sendRatio),version:"current"}),this.uts.init(l,d),[4,Rl()];case 5:(m=v.sent())&&(k.debug("[LIFFUTS][mid] ".concat(m)),this.uts.setMid(m)),r!=null&&r.tid&&(k.debug("[LIFFUTS][tid] ".concat(r.tid)),this.uts.setTid(r.tid)),this.referrer&&(k.debug("liff.ref.referrer",this.referrer),this.uts.setSessionParams(this.referrer)),s&&this.setLiffId(s),this.setIsLoggedIn(z()),this.setVersion(Xt()),h=Hi(location.href),k.debug("[LIFFUTS][url] ".concat(h)),this.uts.setUrl(h),this.liffCore.analytics=this.uts,this.injected=!0,v.label=6;case 6:return[2]}})})},e.prototype.beforeInitSuccess=function(){return this.injected&&(this.setIsLiffSuccessful(!0),this.sendLiffInit()),Promise.resolve()},e.prototype.initError=function(){return this.injected&&(this.setIsLiffSuccessful(!1),this.sendLiffInit()),Promise.resolve()},e}(T),Nl=function(t){k.debug("[LIFFUTS][sendCustom] liff.shareTargetPicker"),t.sendCustom({type:"liffSdk",params:{placeId:"liff.shareTargetPicker"}})},Ul=/([\x90\x9D\x81\x8D\x8F<"{|}>\\^`“›„•‚ŽŠ…’—ž–‘”‡™‰ŒšŸ‹œ†¥¿©áÄýÍÎðô]|\n|.*#.*#|%(?![0-9A-Fa-f]{2})[^%]{0,2})/,Ko=function(t){if(Ul.test(t))throw f(N,"invalid URL.");var e=new URL(t),n=e.username,r=e.password,i=e.hash,o=e.search;return{username:n,password:r,pathname:e.pathname,hash:i,origin:e.origin,search:o.replace(/(?:^|;|&)([^;&]*)[;&]*(?=($|;|&))/g,"$1&").replace(/&+$/g,"").replace(/^\?&/,"?")}},Xr=function(t){return t.substring(1).split("&").filter(function(e){return!/^liff\./.test(e)&&!!e})},xl=function(t,e){var n=t.substring(e.length);return n==="/"?"":(n.length>0&&n[0]!=="/"&&(n="/"+n),n)},Dl=function(t,e){var n,r,i,o=function(s,c){for(var a=ce([],L(s),!1),u=0;u<c.length;u++){var l=c[u],d=a.indexOf(l);d>-1&&a.splice(d,1)}return a}((n=Xr(t).join("&"),r=new URLSearchParams(n).toString().split("&"),i=n.split("&"),r.map(function(s,c){return s.endsWith("=")&&!i[c].endsWith("=")?s.slice(0,-1):s})),Xr(e)).join("&");return o!==""?"?".concat(o):""},$l=function(t){var e=new RegExp("^".concat(Wn.join("|"))),n=t.substring(1).split("&").filter(function(r){return!e.test(r)&&!!r}).join("&");return n?"#".concat(n):""},qo=function(t,e){return e.indexOf(t)===0&&(t.endsWith("/")&&(t=t.substring(0,t.length-1)),e[t.length]===void 0||e[t.length]==="/")},zo=function(t,e){var n=Ko(t),r=new URL(e);if(n.username!==r.username||n.password!==r.password||r.origin!==n.origin||!qo(r.pathname,n.pathname))throw f(N,"invalid URL.")},Ml=function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.extraParams="",n.getAndValidateContext=function(){var r=G();if(!r)throw f(M,"Could not get Context from server.");if(!r.endpointUrl)throw f(M,"Could not get endpointUrl from server.");if(!r.permanentLinkPattern)throw f(M,"Could not get permanentLinkPattern from server.");return r},n.createUrl=function(){var r=n.getAndValidateContext(),i=window.location,o=i.pathname,s=i.search,c=i.hash,a=i.origin,u=new URL(r.endpointUrl);if(u.origin!==a||!qo(u.pathname,o))throw f(ge,"Current page is not under entrypoint.");var l=o.substring(u.pathname.length);l.length>0&&l[0]!=="/"&&(l="/"+l);var d=new RegExp("^".concat(Wn.join("|"))),m=c.substring(1).split("&").filter(function(B){return!d.test(B)&&!!B}).join("&"),h=m===u.hash.substring(1)?"":m,v=function(B){return B.substring(1).split("&").filter(function(Q){return!/liff\.state/.test(Q)&&!!Q})},y=v(s),_=v(u.search);n.extraParams&&y.push(n.extraParams);for(var w=0;w<_.length;w++){var b=_[w],j=y.indexOf(b);j>-1&&y.splice(j,1)}var U=y.join("&"),Y="".concat(l).concat(U!==""?"?".concat(U):"").concat(h?"#".concat(h):"");return"".concat(Mt).concat(D().liffId).concat(Y)},n.createUrlBy=function(r){return p(n,void 0,void 0,function(){var i,o,s,c,a,u;return g(this,function(l){if(!(i=D().liffId))throw f(M,"Should run after liff init.");return o=this.getAndValidateContext(),zo(r,o.endpointUrl),s=Ko(r),c=new URL(o.endpointUrl),a=o.miniDomainAllowed?vn:Mt,u=o.miniDomainAllowed&&o.miniAppId?o.miniAppId:i,[2,a.concat(u,xl(s.pathname,c.pathname),Dl(s.search,c.search),$l(s.hash))]})})},n.setExtraQueryParam=function(r){n.extraParams=r},n.install=function(){return{createUrl:n.createUrl,createUrlBy:n.createUrlBy,setExtraQueryParam:n.setExtraQueryParam}},n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"permanentLink"},enumerable:!1,configurable:!0}),e}(T),Fl=new Ml,We,jl=function(){function t(e,n){var r=this;this.resolve=e,this.reject=n,this.onSubmit=function(i){var o=i.message;r.resolve({value:o}),r.destroy()},this.onClose=function(){r.resolve({value:null}),r.destroy()},this.onCancel=function(){r.resolve({value:null}),r.destroy()},this.onError=function(i){r.reject(i),r.destroy()},this.start()}return t.prototype.start=function(){ne.on("submit",this.onSubmit),ne.on("close",this.onClose),ne.on("cancel",this.onCancel),ne.on("error",this.onError)},t.prototype.destroy=function(){ne.off("submit",this.onSubmit),ne.off("close",this.onClose),ne.off("cancel",this.onCancel),ne.off("error",this.onError),We=void 0},t}();function Bl(){return p(this,void 0,void 0,function(){return g(this,function(t){return Qe.scanCodeV2(),We&&We.destroy(),[2,new Promise(function(e,n){We=new jl(e,n),ne.open({url:"https://liff.line.me/1656359117-jxmx5e11"}).catch(function(r){We==null||We.destroy(),n(r)})})]})})}var Wl=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"scanCodeV2"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return Bl},e}(T),Hl=new Wl,Jo={};function Vl(){return Jo}function Xo(t,e){var n=Vl(),r=L(e.split("."),1)[0],i=n[e];i&&t.removeEventListener(r,i),n[e]=null}var Yr=!1,Qr=!1;function Gl(t,e,n,r){Yr||(Qr=function(){var o=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return o=!0,!1}});window.addEventListener("test",s,s),window.removeEventListener("test",s,s)}catch{o=!1}return o}(),Yr=!0);var i=L(e.split("."),1)[0];return new Promise(function(o){var s=function(c){o(c),n&&n(c),r&&r.once&&Xo(t,e)};(function(c,a){Jo[c]=a})(e,s),t.addEventListener(i,s,!!Qr&&r)})}function Zr(t,e,n,r){if(n===void 0&&(n={}),typeof t!="object"||!t.postMessage)throw f(N,"target must be window object");if(typeof e!="string")throw f(N,"keyname must be string");if(typeof n!="object")throw f(N,"incorrect body format. It should be Object or Array comprised of Object");if(!r)throw f(N,"serverEndPointUrl isn't passed. please fill up with proper url");if(r==="*")throw new Error("serverEndPointUrl doesn't allow to set '*'");var i={name:e,body:n};t.postMessage(i,r)}function Kl(t,e,n,r){Gl(t,"message.".concat(e),function(i,o,s){return function(c){k.debug("messageReceive",c),c.origin===s&&c.data.name===i&&o(c)}}(e,n,r))}var ql=function(){function t(){this.payloadToShareTargetPicker=null,this.popupWindow=null,this.doesWaitForSubwindowResult=!1}return t.getInstance=function(){return t.instance?t.instance.reset():t.instance=new t,t.instance},t.prototype.init=function(e){return p(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return i.trys.push([0,5,,6]),this.liffId=e.referrer.liffId,this.doesWaitForSubwindowResult=!(!e.options||!e.options.waitForSubwindowResult),this.allowPostMessageOrigin=this.initAllowPostMessageOrigin(),this.payloadToShareTargetPicker=this.buildPayloadToShareTargetPicker(e),window.AbortController&&(this.abortController=new window.AbortController),this.prepareAnotherWindow(),[4,this.initOtt()];case 1:return i.sent(),this.initListener(),this.openAnotherWindow(),this.doesWaitForSubwindowResult?[4,this.pollingShareResult()]:[3,3];case 2:return n=i.sent(),this.finalize(),[2,n];case 3:case 6:return[2];case 4:return[3,6];case 5:if(r=i.sent(),this.finalize(),r.name!=="AbortError")throw r;return[3,6]}})})},t.prototype.resetAllVariables=function(){this.liffId="",this.allowPostMessageOrigin="",this.payloadToShareTargetPicker=null,this.ott="",this.popupWindow=null,this.timeoutIDForHealthCheck=null,this.abortController=null,this.internalError=null,this.doesWaitForSubwindowResult=!1},t.prototype.reset=function(){this.finalize(),this.resetAllVariables()},t.prototype.finalize=function(){var e,n;this.abortController&&this.abortController.abort(),C()||(e=this.timeoutIDForHealthCheck,n=this.popupWindow,Xo(window,"message.receivedHealthcheck"),e&&clearTimeout(e),n&&!n.closed&&n.close())},t.prototype.buildPayloadToShareTargetPicker=function(e){return{messages:e.messages,isMultiple:e.isMultiple,referrer:e.referrer}},t.prototype.initAllowPostMessageOrigin=function(e){return e===void 0&&(e=x("shareTargetPicker")),Qc(e)},t.prototype.initOtt=function(){return p(this,void 0,void 0,function(){var e,n,r;return g(this,function(i){switch(i.label){case 0:return this.abortController&&(e=this.abortController.signal),n="".concat(x("shareTargetPickerOtt"),"/").concat(this.liffId,"/ott"),r=this,[4,F(n,{method:"GET",signal:e}).then(function(o){return o.ott})];case 1:return r.ott=i.sent(),[2]}})})},t.prototype.prepareAnotherWindow=function(){C()||(X()!=="ios"||Kn()?this.popupWindow=window.open("","liffpopup","width=480, height=640, menubar=no, toolbar=no, scrollbars=yes"):this.popupWindow=window.open())},t.prototype.openAnotherWindow=function(){if(C()&&this.payloadToShareTargetPicker)e=this.liffId,n=this.ott,r=this.payloadToShareTargetPicker,i={liffId:e,ott:n,data:JSON.stringify(r),closeModals:!1},location.href="".concat("line://picker","?").concat(q.stringify(i));else{if(this.timeoutIDForHealthCheck=window.setTimeout(this.healthCheck.bind(this),1e3),!this.popupWindow)throw f(gn);(function(o,s,c){var a={liffId:s,ott:c};o.location.href="".concat(x("shareTargetPicker"),"?").concat(q.stringify(a))})(this.popupWindow,this.liffId,this.ott)}var e,n,r,i},t.prototype.initListener=function(){var e,n;C()||(e=this.onReceivedHealthcheck.bind(this),n=this.allowPostMessageOrigin,Kl(window,"receivedHealthcheck",e,n))},t.prototype.healthCheck=function(){return p(this,void 0,void 0,function(){var e;return g(this,function(n){switch(n.label){case 0:if(this.popupWindow&&!this.popupWindow.closed)return[3,7];if(!this.doesWaitForSubwindowResult)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.onCanceled()];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),this.internalError=e,[3,4];case 4:return[3,6];case 5:this.finalize(),n.label=6;case 6:return[3,8];case 7:r=this.popupWindow,i=this.allowPostMessageOrigin,Zr(r,"healthcheck",void 0,i),this.timeoutIDForHealthCheck=window.setTimeout(this.healthCheck.bind(this),1e3),n.label=8;case 8:return[2]}var r,i})})},t.prototype.onReceivedHealthcheck=function(){if(!this.popupWindow||!this.payloadToShareTargetPicker)throw f(gn);var e,n,r;e=this.popupWindow,n=this.payloadToShareTargetPicker,r=this.allowPostMessageOrigin,Zr(e,"ready",n,r)},t.prototype.onCanceled=function(){return p(this,void 0,void 0,function(){var e,n;return g(this,function(r){switch(r.label){case 0:if(C()||!this.ott)throw new Error("need to call with ott in client");return this.abortController&&(e=this.abortController.signal),n={liffId:this.liffId,ott:this.ott},[4,F("".concat(x("shareTargetPickerResult"),"?").concat(q.stringify(n)),{method:"POST",signal:e,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:"result=CANCEL"})];case 1:return[2,r.sent().status==="ok"]}})})},t.prototype.getShareResult=function(){return p(this,void 0,void 0,function(){var e,n;return g(this,function(r){if(!this.ott)throw new Error("need to call with ott in client");return this.abortController&&(e=this.abortController.signal),n={liffId:this.liffId,ott:this.ott},k.debug("fetch: getShareResult"),[2,F("".concat(x("shareTargetPickerResult"),"?").concat(q.stringify(n)),{method:"GET",headers:{Accept:"application/json"},signal:e})]})})},t.isPollingTimeOut=function(e,n){return(n-e)/6e4>=10},t.prototype.pollingShareResult=function(){return p(this,void 0,void 0,function(){var e,n;return g(this,function(r){switch(r.label){case 0:e=Date.now(),r.label=1;case 1:if(t.isPollingTimeOut(e,Date.now()))return[3,4];if(this.internalError)throw this.internalError;return[4,this.getShareResult()];case 2:if((n=r.sent())&&n.result)switch(n.result){case"SUCCESS":return[2,{status:"success"}];case"CANCEL":return[2];default:throw new Error(n.resultDescription)}return[4,new Promise(function(i){setTimeout(i,500)})];case 3:return r.sent(),[3,1];case 4:throw new Error("Timeout: not finished within ".concat(10,"min"))}})})},t}(),zl=function(t){function e(){var n=t!==null&&t.apply(this,arguments)||this;return n.shareTargetPicker=function(r,i){return i===void 0&&(i={}),p(n,void 0,void 0,function(){var o,s,c,a,u,l,d;return g(this,function(m){switch(m.label){case 0:if(Qe.shareTargetPicker(),!r||!Array.isArray(r)||r.length===0)throw f(N,"no proper argument");if(r.length>Wc)throw f(N,"exceed the limit of num of messages");if(!(o=D().liffId))throw f(ge);window.liff&&(s=window.liff).analytics&&Nl(s.analytics),c=i.isMultiple===void 0||i.isMultiple,m.label=1;case 1:return m.trys.push([1,3,,4]),a=ql.getInstance(),u=Te(),l={waitForSubwindowResult:!0},C()&&u&&ue(u,"10.11.0")<0&&(l.waitForSubwindowResult=!1),[4,a.init({messages:r,isMultiple:c,referrer:{liffId:o,url:location.origin},options:l})];case 2:return[2,m.sent()];case 3:throw(d=m.sent())instanceof Bi?d:f(mn,d.message);case 4:return[2]}})})},n}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"shareTargetPicker"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return this.shareTargetPicker},e}(T),Jl=new zl;function Yo(t,e){return p(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return n=x("createShortcutOnHomeScreen"),(r=new URL(n)).searchParams.append("liffId",t),r.searchParams.append("url",e.url),e.description&&r.searchParams.append("description",e.description),[4,F(r.toString())];case 1:return[2,i.sent().shortcutPageUrl]}})})}function Qo(t){if(wn(t))throw f(N,"LINE URL scheme are not supported in the current environment.")}function Xl(t,e){return p(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return C()?[2]:[4,new Promise(function(i){setTimeout(i,1e3)})];case 1:return r.sent(),document.visibilityState==="hidden"?[2]:(Qo(e.url),[4,Yo(t,e)]);case 2:return n=r.sent(),Qt({url:n,external:!0}),[2]}})})}function Yl(t,e){return p(this,void 0,void 0,function(){var n,r;return g(this,function(i){switch(i.label){case 0:return n={liffId:t,targetUrl:e.url,description:e.description},r="".concat("line://shortcut/liff","?").concat(q.stringify(n)),location.href=r,[4,Xl(t,e)];case 1:return i.sent(),[2]}})})}function Ql(t,e){return p(this,void 0,void 0,function(){var n;return g(this,function(r){switch(r.label){case 0:return Qo(e.url),[4,Yo(t,e)];case 1:return n=r.sent(),Qt({url:n,external:!0}),[2]}})})}function Zl(t){return p(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return Qe.internalCreateShortcutOnHomeScreen(),[4,Zo(t)];case 1:return e.sent(),[2]}})})}function ed(t){return p(this,void 0,void 0,function(){return g(this,function(e){switch(e.label){case 0:return Qe.createShortcutOnHomeScreen(),[4,Zo(t)];case 1:return e.sent(),[2]}})})}function Zo(t){return p(this,void 0,void 0,function(){var e;return g(this,function(n){switch(n.label){case 0:if(function(r){var i;if(r.url===void 0||r.url===null||r.url==="")throw f(N,"no proper argument");var o=G();if(!(!((i=o==null?void 0:o.availability.addToHomeLineScheme)===null||i===void 0)&&i.permission)){if(wn(r.url))throw f(O,"No permission to specify line schema in url.");if(r.description)throw f(O,"No permission to specify description.")}if(!wn(r.url)){if(!o)throw f(O,"Could not get Context from server.");o.liffId!==Gn(r.url)&&zo(r.url,o.endpointUrl)}}(t),!(e=D().liffId))throw f(M,"Invalid LIFF ID.");return X()==="ios"?[4,Ql(e,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,Yl(e,t)];case 3:n.sent(),n.label=4;case 4:return[2]}})})}var td=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"createShortcutOnHomeScreen"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(n){return ed(n)}},e}(T),nd=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return S(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"internalCreateShortcutOnHomeScreen"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return function(n){return Zl(n)}},e}(T),rd={},ir=Object.defineProperties(rd,{getOS:{value:X,enumerable:!0,writable:!0},getVersion:{value:Xt,enumerable:!0,writable:!0},getLanguage:{value:jo,enumerable:!0,writable:!0},isInClient:{value:C,enumerable:!0,writable:!0},isLoggedIn:{value:z,enumerable:!0,writable:!0},logout:{value:Jn,enumerable:!0,writable:!0},getAccessToken:{value:Ie,enumerable:!0,writable:!0},getIDToken:{value:zt,enumerable:!0,writable:!0},getDecodedIDToken:{value:Jt,enumerable:!0,writable:!0},getContext:{value:G,enumerable:!0,writable:!0},openWindow:{value:Qt,enumerable:!0,writable:!0},closeWindow:{value:Ge,enumerable:!0,writable:!0},getFriendship:{value:Ke(Go,"profile"),enumerable:!0,writable:!0},getAId:{value:qi,enumerable:!0,writable:!0},getProfilePlus:{value:Ji,enumerable:!0,writable:!0},getIsVideoAutoPlay:{value:zi,enumerable:!0,writable:!0},getLineVersion:{value:Te,enumerable:!0,writable:!0},isApiAvailable:{value:yt,enumerable:!0,writable:!0},getProfile:{value:Ke(rr,"profile"),enumerable:!0,writable:!0},sendMessages:{value:Ke(Vo,"chat_message.write"),enumerable:!0,writable:!0},subWindow:{value:ne,enumerable:!0,writable:!0},ready:{value:Bc,enumerable:!0,writable:!0},id:{get:function(){return D().liffId||null},enumerable:!0},_dispatchEvent:{value:Fu,enumerable:!0,writable:!0},_call:{value:Qn,enumerable:!0,writable:!0},_addListener:{value:Xn,enumerable:!0,writable:!0},_removeListener:{value:Yn,enumerable:!0,writable:!0},_postMessage:{value:lo,enumerable:!0,writable:!0}}),or=new jc,es=new Fc(or,ir),id=new Di(or,es).install();function od(t){id.call(ir,t)}[new Di(or,es),new el,new _l,new Ll,Hl,Fl,ro,kl,Jl,rl,new ku,new td,new nd].forEach(od);var Ee=ir;const sd={class:"border raduis-20 p-15"},ad=A("h2",{class:"text-30 fw-bold-7 mb-10"},"Line 登入(新)",-1),cd=A("p",{class:"pb-5"},[A("small",null,[ut("使用 Liff 應用程式讓用戶登入, "),A("br"),ut(" 並取得用戶資料 ")])],-1),ud={class:"text-18 fw-bold-7 mb-5"},ld={key:0,class:"mt-10"},dd=["src"],fd={__name:"LineLoginNewMethodLiff",setup(t){const e=rt(!1),n=rt({});An(()=>{r()});//! Youtube: " #30 LIFF 更新啦 不用LINE也能開？ - v2 版本改動整理 " 解說 LIFF
function r(){Ee.init({liffId:"2002368530-LZo2Dbwd"}).then(async()=>{console.log("開始使用 liff 的 api, liff: ",Ee),e.value=Ee.isLoggedIn(),Ee.isLoggedIn()&&(console.log(await Ee.getProfile()),n.value=await Ee.getProfile())}).catch(s=>{console.log("liff 初始化失敗",s)})}function i(){Ee.login({redirectUri:"https://localhost:5174/thirdPartyLogin/"})}function o(){Ee.logout(),e.value=!1,n.value={}}return(s,c)=>(me(),ve("div",sd,[ad,cd,A("div",ud,[A("p",{class:hs(e.value?"text-success":"text-gray")},Ne(e.value?"登入中":"未登入"),3),n.value.userId?(me(),ve("div",ld,[A("img",{src:n.value.pictureUrl,class:"rounded-pill",alt:"用戶頭貼",width:"50"},null,8,dd),A("p",null,Ne(n.value.displayName),1),A("p",null,Ne(n.value.statusMessage),1)])):ps("",!0)]),e.value?(me(),ve("button",{key:1,type:"button",class:"btn btn-secondary",onClick:o}," Liff 登出 ")):(me(),ve("div",{key:0,class:"btn line-logo mx-auto",onClick:i}))]))}},hd={class:"border raduis-20 p-15"},pd=A("h2",{class:"text-30 fw-bold-7 mb-10"},"Line 登入(舊)",-1),gd=A("p",{class:"pb-5"},[A("small",null,[ut("此方法只能取得用戶 Token, "),A("br"),ut(" 無法取抓用戶資訊")])],-1),md={__name:"LineLoginOldMethod",setup(t){const e="2002361933";console.log('"production": production');const n=`
  https://mizuyang.github.io/thirdPartyLogin/
`;An(()=>{const s=new URLSearchParams(window.location.search).get("code");s&&console.log("token: ",s)});function r(){const o=`
  https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=${e}&redirect_uri=${n}&state=login&scope=profile%20openid&nonce=09876xyz
  `;window.location.href=o}function i(){const o=`
   https://access.line.me/dialog/oauth/weblogin?response_type=code&client_id=${e}&redirect_uri=${n}&state=123abc
  `;window.location.href=o}return(o,s)=>(me(),ve("div",hd,[pd,gd,A("div",{class:"btn line-logo mx-auto",onClick:r}),A("div",{class:"text-center"},[A("button",{type:"button",class:"btn btn-primary",onClick:i}," 授權應用程式權限 ")])]))}};const vd={class:"position-absolute-center w-100 text-center px-15"},wd={class:"row row-cols-3"},bd={__name:"HomeView",setup(t){return(e,n)=>(me(),ve("div",vd,[A("div",wd,[Zt(Sc),Zt(fd),Zt(md)])]))}};export{bd as default};
